function ...
[ ...
 UX_T_M_l2_gpu_dM__ ...
] = ...
tfpmh_UX_T_M_l2_gpu_dM__0( ....
 n_delta_v ...
,n_k_p_r ...
,n_w_max ...
,n_M ...
,pm_n_UX_rank ...
,UX_T_M_k_q_gpu_dwnM____ ...
);
% assumes n_w_ = n_w_max*ones(n_k_p_r,1);
flag_verbose=1;

f_zero = gpuArray( single(0.0));
if ~strcmp(class(UX_T_M_k_q_gpu_dwnM____),'gpuArray');
tmp_t = tic();
UX_T_M_k_q_gpu_dwnM____ = gpuArray( (UX_T_M_k_q_gpu_dwnM____));
tmp_t = toc(tmp_t); if (flag_verbose>0); disp(sprintf(' %% UX_T_M_k_q_gpu_dwnM____ %0.6fs',tmp_t)); end;
end;%if ~strcmp(class(UX_T_M_k_q_gpu_dwnM____),'gpuArray');

UX_T_M_l2_gpu_dM__ = zeros(n_delta_v,n_M,'like',f_zero);
UX_T_M_l2_gpu_dM__ = reshape(real(sum(abs(UX_T_M_k_q_gpu_dwnM____).^2,1+[1,2])),[n_delta_v,n_M]) / max(1,n_w_max) ;
