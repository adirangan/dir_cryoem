function ...
[ ...
  UX_T_M_k_q_dwnM____ ...
] = ....
tpmh_UXTM_dwnM____0( ...
 FTK ...
,n_k_p_r ...
,k_p_r_ ...
,n_w_ ...
,n_M ...
,M_k_p_wkM__ ...
,pm_n_UX_rank ...
,pm_UX_kn__ ...
,pm_X_weight_r_ ...
);

str_thisfunction = 'tpmh_UXTM_dwnM____0';

na=0;
if (nargin<1+na); FTK=[]; end; na=na+1;
if (nargin<1+na); n_k_p_r=[]; end; na=na+1;
if (nargin<1+na); k_p_r_=[]; end; na=na+1;
if (nargin<1+na); n_w_=[]; end; na=na+1;
if (nargin<1+na); n_M=[]; end; na=na+1;
if (nargin<1+na); M_k_p_wkM__=[]; end; na=na+1;
if (nargin<1+na); pm_n_UX_rank=[]; end; na=na+1;
if (nargin<1+na); pm_UX_kn__=[]; end; na=na+1;
if (nargin<1+na); pm_X_weight_r_=[]; end; na=na+1;

flag_verbose=0;
%%%%%%%%;
if (flag_verbose>0); disp(sprintf(' %% [entering %s]',str_thisfunction)); end;
%%%%%%%%;

n_w_ = n_w_(:); n_w_max = max(n_w_); n_w_sum = sum(n_w_); n_w_csum_ = cumsum([0;n_w_]);
if (numel(unique(n_w_))> 1); disp(sprintf(' %% Warning, n_w_ not uniform in %s',str_thisfunction)); end;

n_delta_v = FTK.n_delta_v;
delta_x_dM__ = repmat(reshape(FTK.delta_x_,[n_delta_v,1]),[1,n_M]);
delta_y_dM__ = repmat(reshape(FTK.delta_y_,[n_delta_v,1]),[1,n_M]);
[ ...
 T_M_k_p_wkdM___ ...
] = ...
transf_p_to_p_uniform_over_n_k_p_r_0( ...
 n_k_p_r ...
,k_p_r_ ...
,n_w_ ...
,n_M ...
,M_k_p_wkM__ ...
,n_delta_v ...
,delta_x_dM__ ...
,delta_y_dM__ ...
);

pm_wUX_kn__ = diag(pm_X_weight_r_)*pm_UX_kn__;
UX_T_M_k_p_wndM____ = reshape(pagetranspose(pagemtimes(pm_wUX_kn__,'transpose',reshape(T_M_k_p_wkdM___,[n_w_max,n_k_p_r,n_delta_v,n_M]),'transpose')),[n_w_max,pm_n_UX_rank,n_delta_v,n_M]);

pm_n_w_ = n_w_max*ones(pm_n_UX_rank,1); pm_n_w_sum = sum(pm_n_w_);
UX_T_M_k_q_wndM____ = interp_p_to_q(pm_n_UX_rank,pm_n_w_,pm_n_w_sum,UX_T_M_k_p_wndM____);

UX_T_M_k_q_dwnM____ = permute(UX_T_M_k_q_wndM____,1+[2,0,1,3]);

%%%%%%%%;
if (flag_verbose>0); disp(sprintf(' %% [finished %s]',str_thisfunction)); end;
%%%%%%%%;
