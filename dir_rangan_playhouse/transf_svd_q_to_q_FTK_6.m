function M_q_ = transf_svd_q_to_q_FTK_6(FTK,n_r,grid_p_,n_w_,n_A,S_q_,delta_x,delta_y);
% multiplies grid_p_ by 2*pi ;

warning_flag = 1;

svd_r_max = FTK.svd_r_max;
n_svd_r = FTK.n_svd_r;
svd_r_ = FTK.svd_r_;
svd_d_max = FTK.svd_d_max;
n_svd_d = FTK.n_svd_d;
svd_d_ = FTK.svd_d_;
n_svd_l = FTK.n_svd_l;
svd_l_ = FTK.svd_l_;
svd_U_d_ = FTK.svd_U_d_;
svd_s_ = FTK.svd_s_;
svd_V_r_ = FTK.svd_V_r_;

Z_q_ = zeros(n_A,1);
U_d_ = zeros(n_svd_l,1);
svd_d_m = svd_d_max / 2.0;
svd_d_c = svd_d_m;
delta = sqrt(delta_x^2 + delta_y^2);
omega = atan2(delta_y,delta_x);
if (delta>svd_d_max & warning_flag);
disp(sprintf(' %% Warning, delta %0.6f > svd_d_max %0.6f',delta,svd_d_max));
end;%if;
svd_d = (delta - svd_d_m)/svd_d_c;
for nl=0:n_svd_l-1;
U_d_(1+nl) = polyval_r8_reverse_0(n_svd_d,svd_U_d_(1+0+nl*n_svd_d+(0:n_svd_d-1)),1,svd_d);
end;%for nl=0:n_svd_l-1;
V_r_ = zeros(n_svd_l*n_r,1);
svd_r_m = svd_r_max / 2.0;
svd_r_c = svd_r_m;
for nr=0:n_r-1;
if (2*pi*grid_p_(1+nr)>svd_r_max & warning_flag);
disp(sprintf(' %% Warning, 2*pi*grid_p_(1+nr) %0.6f > svd_r_max %0.6f',2*pi*grid_p_(1+nr),svd_r_max));
end;%if;
svd_r = (2*pi*grid_p_(1+nr) - svd_r_m)/svd_r_c;
for nl=0:n_svd_l-1;
V_r_(1+nl+nr*n_svd_l) = polyval_r8_reverse_0(n_svd_r,svd_V_r_(1+0+nl*n_svd_r+(0:n_svd_r-1)),1,svd_r);
end;%for nl=0:n_svd_l-1;
end;%for nr=0:n_r-1;
C_w_ = zeros(n_svd_l,1);
ic=0;
for nr=0:n_r-1;
for nl=0:n_svd_l-1;
theta = svd_l_(1+nl)*(pi/2 - omega);
C_w = +cos(theta) - i*sin(theta);
D_V_r = V_r_(1+nl+nr*n_svd_l);
D_U_d = U_d_(1+nl);
D_s = svd_s_(1+nl);
C_w_(1+nl) = (D_U_d * D_s * D_V_r) * C_w;
end;%for nl=0:n_svd_l-1;
for nw=0:n_w_(1+nr)-1;
Z_q_(1+ic) = 0;
n_w_t = floor(1.0d0*n_w_(1+nr)/2.0d0);
for nl=0:n_svd_l-1;
I_l = svd_l_(1+nl);
C_q = C_w_(1+nl);
nwc = nw;
if (nwc>=n_w_t);
nwc = nwc - n_w_(1+nr);
end;%if;
flag_ict_overflow = 0;
nwd = nwc + I_l;
if (abs(nwd)<n_w_t);
nwt = periodize(nwd,0,n_w_(1+nr));
 else;
nwt = 0;
flag_ict_overflow = 1;
end;%if;
ict = ic-nw+nwt;
if (flag_ict_overflow==0);
Z_q_(1+ic) = Z_q_(1+ic) + C_q*S_q_(1+ict);
end;%if;
end;%for nl=0:n_svd_l-1;
ic = ic + 1;
end;%for nw=0:n_w_(1+nr)-1;
end;%for nr=0:n_r-1;
M_q_ = Z_q_;

