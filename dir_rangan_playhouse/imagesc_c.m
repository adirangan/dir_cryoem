function imagesc_c(n_x,x_,n_y,y_,S_c_,clim,cra_);
% cartesian imagesc;
% assumes S_c_(nx,ny) = S_c_(nx + ny*n_x);
if isempty(clim); 
clim = mean(S_c_(:)) + std(S_c_(:))*2.5*[-1,1]; 
end;%if isempty(clim);
dx_ = diff(x_); dy_ = diff(y_);
x0_ = zeros(1,n_x*n_y);
x1_ = zeros(1,n_x*n_y);
y0_ = zeros(1,n_x*n_y);
y1_ = zeros(1,n_x*n_y);
ncra = size(cra_,1);
C_ = zeros(1,n_x*n_y,3);
ic=0;
for ny=0:n_y-1;
if (ny==0); y_pre = y_(1)-0.5*dy_(1); else; y_pre = 0.5*(y_(1+ny-1)+y_(1+ny)); end;
if (ny==n_y-1); y_pos = y_(end)+0.5*dy_(end); else; y_pos = 0.5*(y_(1+ny+1)+y_(1+ny)); end;
for nx=0:n_x-1;
if (nx==0); x_pre = x_(1)-0.5*dx_(1); else; x_pre = 0.5*(x_(1+nx-1)+x_(1+nx)); end;
if (nx==n_x-1); x_pos = x_(end)+0.5*dx_(end); else; x_pos = 0.5*(x_(1+nx+1)+x_(1+nx)); end;
x0_(1+ic) = x_pre; x1_(1+ic) = x_pos;
y0_(1+ic) = y_pre; y1_(1+ic) = y_pos;
nc = max(1,min(ncra,floor(ncra*(S_c_(1+ic) - min(clim))/diff(clim))));
C_(1,1+ic,1:3) = cra_(nc,:);
ic = ic+1;
end;%for nx=0:n_x-1;
end;%for ny=0:n_y-1;
X_ = [x0_ ; x0_ ; x1_ ; x1_ ; x0_];
Y_ = [y0_ ; y1_ ; y1_ ; y0_ ; y0_];
p=patch(X_,Y_,C_); set(p,'EdgeColor','none');
