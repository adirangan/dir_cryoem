% compares the result of interp2 and interp2_nufft. ;
rng(1);
n_x1 = 9; n_x2 = n_x1+2;
x1_ = transpose(linspace(0,2*pi,n_x1+1)); x1_ = x1_(1:end-1);
x2_ = transpose(linspace(0,2*pi,n_x2+1)); x2_ = x2_(1:end-1);
X1_ = reshape(x1_*ones(1,n_x2),n_x1,n_x2);
X2_ = reshape(ones(n_x1,1)*transpose(x2_),n_x1,n_x2);
n_y1 = 128; n_y2 = 128+2;
y1_ = transpose(linspace(0,2*pi,n_y1+1)); y1_ = y1_(1:end-1);
y2_ = transpose(linspace(0,2*pi,n_y2+1)); y2_ = y2_(1:end-1);
Y1_ = reshape(y1_*ones(1,n_y2),n_y1,n_y2);
Y2_ = reshape(ones(n_y1,1)*transpose(y2_),n_y1,n_y2);
n_z = 1024*2;
z1_ = 2*pi*rand(n_z,1); z2_ = 2*pi*rand(n_z,1);
%%%%%%%%;
%s = @(x_) sin(x_);
s = @(X1_,X2_) ( 1.0 + sin(X1_) + 0.5*cos(2*X1_) + 0.25*sin(3*X1_) ) .* ( 1.0 + cos(X2_) + 0.25*cos(2*X2_) );
f_ = s(X1_,X2_);
g_ = s(Y1_,Y2_);
f1_ = zeros(n_z,1);
for nz=0:n_z-1;
f1_(1+nz) = interp2(n_x1,0,2*pi,n_x2,0,2*pi,f_,z1_(1+nz),z2_(1+nz));
end;%for nz=0:n_z-1;
f2_ = real(interp2_nufft(n_x1,0,2*pi,n_x2,0,2*pi,f_,z1_,z2_));

%%%%%%%%;
subplot(1,2,1);
cla;
colormap(colormap_beach());
hold on;
mesh(Y1_,Y2_,g_);
plot3(X1_,X2_,f_,'ro','MarkerSize',15);
plot3(z1_,z2_,f1_,'ko','MarkerSize',10);
hold off;
axis vis3d;
view([-65,20]);
xlabel('x1');
ylabel('x2');
title('linear interpolation');
%%%%%%%%;
subplot(1,2,2);
cla;
colormap(colormap_beach());
hold on;
mesh(Y1_,Y2_,g_);
plot3(X1_,X2_,f_,'ro','MarkerSize',15);
plot3(z1_,z2_,f2_,'ko','MarkerSize',10);
hold off;
axis vis3d;
view([-65,20]);
xlabel('x1');
ylabel('x2');
title('nufft');
%%%%%%%%;
figbig;
