function ...
[ ...
 output ...
,dS0_output ...
,dS1_output ...
,dM0_output ...
,dM1_output ...
,dS0dS0_output ...
,dS0dS1_output ...
,dS1dS0_output ...
,dS1dS1_output ...
,dS0dM0_output ...
,dS0dM1_output ...
,dS1dM0_output ...
,dS1dM1_output ...
,dM0dS0_output ...
,dM0dS1_output ...
,dM1dS0_output ...
,dM1dS1_output ...
,dM0dM0_output ...
,dM0dM1_output ...
,dM1dM0_output ...
,dM1dM1_output ...
] = ...
I_xPPx_0( ...
 K ...
,phi_S ...
,delta_S_ ...
,phi_M ...
,delta_M_ ...
);
%%%%%%%%;
% calculates the integral: ;
% \int_{k=0}^{K} \int_{psi=0}^{2*pi} conj[CTF * S] * M dpsi * kdk ;
% where: ;
% CTF = 2*k*cos(psi - phi_S) ;
% S   = exp( +i*2*pi*k*delta_S * cos(psi - omega_S) ) ;
% M   = 2*k*cos(psi - phi_M) * exp( +i*2*pi*k*delta_M * cos(psi - omega_M) ) ;
% where: ;
% delta_S_ = delta_S * [cos(omega_S);sin(omega_S)] ;
% delta_M_ = delta_M * [cos(omega_M);sin(omega_M)] ;
%%%%;
% Derivatives are calculated with respect to perturbations in: ;
% delta_S_(1+0) and delta_S_(1+1). ;
% delta_M_(1+0) and delta_M_(1+1). ;
%%%%%%%%;
str_thisfunction = 'I_xPPx_0';

if nargin<1;
flag_verbose=1; flag_disp=0; nf=0;
if flag_verbose>0; disp(sprintf(' %% testing %s',str_thisfunction)); end;
%%%%%%%%;
% Now set up polar-quadrature-weights on disk. ;
%%%%%%%%;
k_int = 48;
k_eq_d_double = 0.25;
n_w_int = 4;
k_p_r_max = k_int/(2*pi); k_eq_d = k_eq_d_double/(2*pi); str_L = 'L';
[ ...
 n_k_p_r ...
,k_p_r_ ...
,weight_3d_k_p_r_ ...
] = ...
get_weight_3d_1( ...
 flag_verbose ...
,k_p_r_max ...
,k_eq_d ...
,str_L ...
);
%%%%;
l_max_upb = round(2*pi*k_p_r_max);
l_max_max = min(l_max_upb,1+ceil(2*pi*k_p_r_(end)));
n_w_max = n_w_int*2*(l_max_max+1); n_w_0in = n_w_max; n_w_0in_ = n_w_max*ones(n_k_p_r,1);
[ ...
 n_w_ ...
,weight_2d_k_p_r_ ...
,weight_2d_wk_ ...
,k_p_r_wk_ ...
,k_p_w_wk_ ...
,k_c_0_wk_ ...
,k_c_1_wk_ ...
] = ...
get_weight_2d_2( ...
 0*flag_verbose ...
,n_k_p_r ...
,k_p_r_ ...
,k_p_r_max ...
,-1 ...
,n_w_0in_ ...
);
n_w_sum = sum(n_w_); n_w_csum_ = cumsum([0;n_w_]);
%%%%%%%%;
% Generate images, template and integral. ;
%%%%%%%%;
rng(2);
K = k_p_r_max;
phi_S = 2*pi*rand();
delta_S_ = 1e-1*2*pi*rand(2,1); delta_S = fnorm(delta_S_); omega_S = atan2(delta_S_(1+1),delta_S_(1+0));
phi_M = 2*pi*rand();
delta_M_ = 1e-1*2*pi*rand(2,1); delta_M = fnorm(delta_M_); omega_M = atan2(delta_M_(1+1),delta_M_(1+0));
S_k_p_wk_ = exp(2*pi*i*k_p_r_wk_.*delta_S.*cos(k_p_w_wk_ - omega_S));
CTF_k_p_wk_ = 2*k_p_r_wk_.*cos(k_p_w_wk_ - phi_S);
M_k_p_wk_ = 2*k_p_r_wk_.*cos(k_p_w_wk_ - phi_M).*exp(2*pi*i*k_p_r_wk_.*delta_M.*cos(k_p_w_wk_ - omega_M));
%%%%;
if flag_disp;
figure(1+nf);nf=nf+1;clf;figbig; p_row=2;p_col=2;np=0;
Slim_ = max(abs(S_k_p_wk_),[],'all')*[-1,+1];
Mlim_ = max(abs(M_k_p_wk_),[],'all')*[-1,+1];
subplot(p_row,p_col,1+np);np=np+1; imagesc_p(n_k_p_r,k_p_r_,n_w_,n_w_sum,real(S_k_p_wk_),Slim_); axis image; axisnotick; title('real(S_k_p_wk_)','Interpreter','none');
subplot(p_row,p_col,1+np);np=np+1; imagesc_p(n_k_p_r,k_p_r_,n_w_,n_w_sum,imag(S_k_p_wk_),Slim_); axis image; axisnotick; title('imag(S_k_p_wk_)','Interpreter','none');
subplot(p_row,p_col,1+np);np=np+1; imagesc_p(n_k_p_r,k_p_r_,n_w_,n_w_sum,real(M_k_p_wk_),Mlim_); axis image; axisnotick; title('real(M_k_p_wk_)','Interpreter','none');
subplot(p_row,p_col,1+np);np=np+1; imagesc_p(n_k_p_r,k_p_r_,n_w_,n_w_sum,imag(M_k_p_wk_),Mlim_); axis image; axisnotick; title('imag(M_k_p_wk_)','Interpreter','none');
end;%if flag_disp;
%%%%;
output_qua = sum(conj(CTF_k_p_wk_.*S_k_p_wk_).*M_k_p_wk_.*weight_2d_wk_,'all')*(2*pi)^2;
[ ...
 output_mid ...
,dS0_output_mid ...
,dS1_output_mid ...
,dM0_output_mid ...
,dM1_output_mid ...
,dS0dS0_output_mid ...
,dS0dS1_output_mid ...
,dS1dS0_output_mid ...
,dS1dS1_output_mid ...
,dS0dM0_output_mid ...
,dS0dM1_output_mid ...
,dS1dM0_output_mid ...
,dS1dM1_output_mid ...
,dM0dS0_output_mid ...
,dM0dS1_output_mid ...
,dM1dS0_output_mid ...
,dM1dS1_output_mid ...
,dM0dM0_output_mid ...
,dM0dM1_output_mid ...
,dM1dM0_output_mid ...
,dM1dM1_output_mid ...
] = ...
I_xPPx_0( ...
 K ...
,phi_S ...
,delta_S_ ...
,phi_M ...
,delta_M_ ...
);
%%%%;
fnorm_disp(flag_verbose,'output_qua',output_qua,'output_mid',output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
%%%%;
ddelta = 1e-5;
d_delta_S_ = pi*randn(2,1);
d_delta_M_ = pi*randn(2,1);
[ ...
 output_pos ...
] = ...
I_xPPx_0( ...
 K ...
,phi_S ...
,delta_S_ + ddelta*d_delta_S_ ...
,phi_M ...
,delta_M_ + ddelta*d_delta_M_ ...
);
[ ...
 output_neg ...
] = ...
I_xPPx_0( ...
 K ...
,phi_S ...
,delta_S_ - ddelta*d_delta_S_ ...
,phi_M ...
,delta_M_ - ddelta*d_delta_M_ ...
);
%%%%;
d_output_mid = dS0_output_mid * d_delta_S_(1+0) + dS1_output_mid * d_delta_S_(1+1) + dM0_output_mid * d_delta_M_(1+0) + dM1_output_mid * d_delta_M_(1+1) ;
d_output_dif = (output_pos - output_neg)/max(1e-12,2*ddelta);
fnorm_disp(flag_verbose,'d_output_dif',d_output_dif,'d_output_mid',d_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
dd_output_mid = ...
+ dS0dS0_output_mid * d_delta_S_(1+0) * d_delta_S_(1+0) ...
+ dS0dS1_output_mid * d_delta_S_(1+0) * d_delta_S_(1+1) ...
+ dS1dS0_output_mid * d_delta_S_(1+1) * d_delta_S_(1+0) ...
+ dS1dS1_output_mid * d_delta_S_(1+1) * d_delta_S_(1+1) ...
+ dS0dM0_output_mid * d_delta_S_(1+0) * d_delta_M_(1+0) ...
+ dS0dM1_output_mid * d_delta_S_(1+0) * d_delta_M_(1+1) ...
+ dS1dM0_output_mid * d_delta_S_(1+1) * d_delta_M_(1+0) ...
+ dS1dM1_output_mid * d_delta_S_(1+1) * d_delta_M_(1+1) ...
+ dM0dS0_output_mid * d_delta_M_(1+0) * d_delta_S_(1+0) ...
+ dM0dS1_output_mid * d_delta_M_(1+0) * d_delta_S_(1+1) ...
+ dM1dS0_output_mid * d_delta_M_(1+1) * d_delta_S_(1+0) ...
+ dM1dS1_output_mid * d_delta_M_(1+1) * d_delta_S_(1+1) ...
+ dM0dM0_output_mid * d_delta_M_(1+0) * d_delta_M_(1+0) ...
+ dM0dM1_output_mid * d_delta_M_(1+0) * d_delta_M_(1+1) ...
+ dM1dM0_output_mid * d_delta_M_(1+1) * d_delta_M_(1+0) ...
+ dM1dM1_output_mid * d_delta_M_(1+1) * d_delta_M_(1+1) ...
;
dd_output_dif = (output_pos - 2*output_mid + output_neg)/max(1e-12,ddelta.^2);
fnorm_disp(flag_verbose,'dd_output_dif',dd_output_dif,'dd_output_mid',dd_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
%%%%;
dS0 = 1.8e-5; dS1 = 3.6e-5;
dM0 = 0.9e-5; dM1 = 2.7e-5;
%%;
[ output_mid_mid_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
%%;
[ output_pos_mid_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_mid_pos_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; +1*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_mid_mid_pos_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ +1*dM0 ;  0*dM1 ]);
[ output_mid_mid_mid_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ; +1*dM1 ]);
%%;
[ output_neg_mid_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_mid_neg_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; -1*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_mid_mid_neg_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ -1*dM0 ;  0*dM1 ]);
[ output_mid_mid_mid_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ; -1*dM1 ]);
%%;
[ output_pos_pos_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ; +1*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_pos_mid_pos_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ +1*dM0 ;  0*dM1 ]);
[ output_pos_mid_mid_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ; +1*dM1 ]);
[ output_mid_pos_pos_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; +1*dS1 ],phi_M,delta_M_ + [ +1*dM0 ;  0*dM1 ]);
[ output_mid_pos_mid_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; +1*dS1 ],phi_M,delta_M_ + [  0*dM0 ; +1*dM1 ]);
[ output_mid_mid_pos_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ +1*dM0 ; +1*dM1 ]);
%%;
[ output_neg_neg_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ; -1*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_neg_mid_neg_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ -1*dM0 ;  0*dM1 ]);
[ output_neg_mid_mid_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ; -1*dM1 ]);
[ output_mid_neg_neg_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; -1*dS1 ],phi_M,delta_M_ + [ -1*dM0 ;  0*dM1 ]);
[ output_mid_neg_mid_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; -1*dS1 ],phi_M,delta_M_ + [  0*dM0 ; -1*dM1 ]);
[ output_mid_mid_neg_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ -1*dM0 ; -1*dM1 ]);
%%;
[ output_pos_neg_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ; -1*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_pos_mid_neg_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ -1*dM0 ;  0*dM1 ]);
[ output_pos_mid_mid_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [ +1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ; -1*dM1 ]);
[ output_mid_pos_neg_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; +1*dS1 ],phi_M,delta_M_ + [ -1*dM0 ;  0*dM1 ]);
[ output_mid_pos_mid_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; +1*dS1 ],phi_M,delta_M_ + [  0*dM0 ; -1*dM1 ]);
[ output_mid_mid_pos_neg ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ +1*dM0 ; -1*dM1 ]);
%%;
[ output_neg_pos_mid_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ; +1*dS1 ],phi_M,delta_M_ + [  0*dM0 ;  0*dM1 ]);
[ output_neg_mid_pos_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ +1*dM0 ;  0*dM1 ]);
[ output_neg_mid_mid_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [ -1*dS0 ;  0*dS1 ],phi_M,delta_M_ + [  0*dM0 ; +1*dM1 ]);
[ output_mid_neg_pos_mid ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; -1*dS1 ],phi_M,delta_M_ + [ +1*dM0 ;  0*dM1 ]);
[ output_mid_neg_mid_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ; -1*dS1 ],phi_M,delta_M_ + [  0*dM0 ; +1*dM1 ]);
[ output_mid_mid_neg_pos ] = I_xPPx_0(K,phi_S,delta_S_ + [  0*dS0 ;  0*dS1 ],phi_M,delta_M_ + [ -1*dM0 ; +1*dM1 ]);
%%;
dS0dS0_output_dif = ( +output_pos_mid_mid_mid - 2*output_mid_mid_mid_mid + output_neg_mid_mid_mid )/max(1e-12,1*dS0*dS0);
dS1dS1_output_dif = ( +output_mid_pos_mid_mid - 2*output_mid_mid_mid_mid + output_mid_neg_mid_mid )/max(1e-12,1*dS1*dS1);
dM0dM0_output_dif = ( +output_mid_mid_pos_mid - 2*output_mid_mid_mid_mid + output_mid_mid_neg_mid )/max(1e-12,1*dM0*dM0);
dM1dM1_output_dif = ( +output_mid_mid_mid_pos - 2*output_mid_mid_mid_mid + output_mid_mid_mid_neg )/max(1e-12,1*dM1*dM1);
fnorm_disp(flag_verbose,'dS0dS0_output_dif',dS0dS0_output_dif,'dS0dS0_output_mid',dS0dS0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dS1dS1_output_dif',dS1dS1_output_dif,'dS1dS1_output_mid',dS1dS1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM0dM0_output_dif',dM0dM0_output_dif,'dM0dM0_output_mid',dM0dM0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM1dM1_output_dif',dM1dM1_output_dif,'dM1dM1_output_mid',dM1dM1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
%%;
dS0dS1_output_dif = ( -output_pos_neg_mid_mid - output_neg_pos_mid_mid + output_pos_pos_mid_mid + output_neg_neg_mid_mid )/max(1e-12,4*dS0*dS1);
dS0dM0_output_dif = ( -output_pos_mid_neg_mid - output_neg_mid_pos_mid + output_pos_mid_pos_mid + output_neg_mid_neg_mid )/max(1e-12,4*dS0*dM0);
dS0dM1_output_dif = ( -output_pos_mid_mid_neg - output_neg_mid_mid_pos + output_pos_mid_mid_pos + output_neg_mid_mid_neg )/max(1e-12,4*dS0*dM1);
dS1dM0_output_dif = ( -output_mid_pos_neg_mid - output_mid_neg_pos_mid + output_mid_pos_pos_mid + output_mid_neg_neg_mid )/max(1e-12,4*dS1*dM0);
dS1dM1_output_dif = ( -output_mid_pos_mid_neg - output_mid_neg_mid_pos + output_mid_pos_mid_pos + output_mid_neg_mid_neg )/max(1e-12,4*dS1*dM1);
dM0dM1_output_dif = ( -output_mid_mid_pos_neg - output_mid_mid_neg_pos + output_mid_mid_pos_pos + output_mid_mid_neg_neg )/max(1e-12,4*dM0*dM1);
dS1dS0_output_dif = dS0dS1_output_dif;
dM0dS0_output_dif = dS0dM0_output_dif;
dM1dS0_output_dif = dS0dM1_output_dif;
dM0dS1_output_dif = dS1dM0_output_dif;
dM1dS1_output_dif = dS1dM1_output_dif;
dM1dM0_output_dif = dM0dM1_output_dif;
fnorm_disp(flag_verbose,'dS0dS1_output_dif',dS0dS1_output_dif,'dS0dS1_output_mid',dS0dS1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dS1dS0_output_dif',dS1dS0_output_dif,'dS1dS0_output_mid',dS1dS0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dS0dM0_output_dif',dS0dM0_output_dif,'dS0dM0_output_mid',dS0dM0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM0dS0_output_dif',dM0dS0_output_dif,'dM0dS0_output_mid',dM0dS0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dS0dM1_output_dif',dS0dM1_output_dif,'dS0dM1_output_mid',dS0dM1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM1dS0_output_dif',dM1dS0_output_dif,'dM1dS0_output_mid',dM1dS0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dS1dM0_output_dif',dS1dM0_output_dif,'dS1dM0_output_mid',dS1dM0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM0dS1_output_dif',dM0dS1_output_dif,'dM0dS1_output_mid',dM0dS1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dS1dM1_output_dif',dS1dM1_output_dif,'dS1dM1_output_mid',dS1dM1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM1dS1_output_dif',dM1dS1_output_dif,'dM1dS1_output_mid',dM1dS1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM0dM1_output_dif',dM0dM1_output_dif,'dM0dM1_output_mid',dM0dM1_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
fnorm_disp(flag_verbose,'dM1dM0_output_dif',dM1dM0_output_dif,'dM1dM0_output_mid',dM1dM0_output_mid,' %<-- should be small (e.g., <1e-6 if quadrature resolved)');
%%%%;
if flag_verbose>0; disp(sprintf(' %% returning')); end; return;
end;%if nargin<1;

na=0;
if (nargin<1+na); K=[]; end; na=na+1;
if (nargin<1+na); phi_S=[]; end; na=na+1;
if (nargin<1+na); delta_S_=[]; end; na=na+1;
if (nargin<1+na); phi_M=[]; end; na=na+1;
if (nargin<1+na); delta_M_=[]; end; na=na+1;

if isempty(K); K = 48.0/(2*pi); end;
if isempty(phi_S); phi_S = 0.0*pi; end;
if isempty(delta_S_); delta_S_ = [1.0;0.0]; end;
if isempty(phi_M); phi_M = 0.5*pi; end;
if isempty(delta_M_); delta_M_ = [0.0;1.0]; end;

flag_1 = 1;
flag_d = nargout>=1+1;
flag_dd = nargout>=1+5;

if flag_d;
d00 = 1; d01 = 0;
d10 = 0; d11 = 1;
end;%if flag_d;

delta_T_ = delta_M_ - delta_S_ ;
delta_T = sqrt(delta_T_(1+0).^2 + delta_T_(1+1).^2) ;
if flag_d;
dS0_delta_T = -delta_T_(1+0)./max(1e-12,delta_T) ;
dS1_delta_T = -delta_T_(1+1)./max(1e-12,delta_T) ;
dM0_delta_T = +delta_T_(1+0)./max(1e-12,delta_T) ;
dM1_delta_T = +delta_T_(1+1)./max(1e-12,delta_T) ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_delta_T = +d00/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS0dS1_delta_T = +d01/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dS1dS0_delta_T = +d10/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS1dS1_delta_T = +d11/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
dS0dM0_delta_T = -d00/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS0dM1_delta_T = -d01/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dS1dM0_delta_T = -d10/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS1dM1_delta_T = -d11/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
dM0dS0_delta_T = -d00/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM0dS1_delta_T = -d01/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dM1dS0_delta_T = -d10/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM1dS1_delta_T = -d11/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
dM0dM0_delta_T = +d00/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM0dM1_delta_T = +d01/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dM1dM0_delta_T = +d10/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM1dM1_delta_T = +d11/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
end;%if flag_dd;
omega_T = atan2(delta_T_(1+1),delta_T_(1+0)) ;
if flag_d;
dS0_omega_T = +(delta_T_(1+1)*d00  - delta_T_(1+0)*d01)./max(1e-12,delta_T).^2;
dS1_omega_T = +(delta_T_(1+1)*d10  - delta_T_(1+0)*d11)./max(1e-12,delta_T).^2;
dM0_omega_T = -(delta_T_(1+1)*d00  - delta_T_(1+0)*d01)./max(1e-12,delta_T).^2;
dM1_omega_T = -(delta_T_(1+1)*d10  - delta_T_(1+0)*d11)./max(1e-12,delta_T).^2;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_omega_T = +(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS0dS1_omega_T = +(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dS1dS0_omega_T = +(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS1dS1_omega_T = +(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
dS0dM0_omega_T = -(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS0dM1_omega_T = -(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dS1dM0_omega_T = -(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS1dM1_omega_T = -(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
dM0dS0_omega_T = -(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM0dS1_omega_T = -(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dM1dS0_omega_T = -(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM1dS1_omega_T = -(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
dM0dM0_omega_T = +(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM0dM1_omega_T = +(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dM1dM0_omega_T = +(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM1dM1_omega_T = +(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
end;%if flag_dd;
phi_p = phi_S + phi_M ;
phi_n = phi_S - phi_M ;
t = 2*pi*delta_T ;
tK = t*K ;
if flag_d;
dS0_tK = 2*pi*K*dS0_delta_T;
dS1_tK = 2*pi*K*dS1_delta_T;
dM0_tK = 2*pi*K*dM0_delta_T;
dM1_tK = 2*pi*K*dM1_delta_T;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_tK = 2*pi*K*dS0dS0_delta_T;
dS0dS1_tK = 2*pi*K*dS0dS1_delta_T;
dS1dS0_tK = 2*pi*K*dS1dS0_delta_T;
dS1dS1_tK = 2*pi*K*dS1dS1_delta_T;
%%%%;
dS0dM0_tK = 2*pi*K*dS0dM0_delta_T;
dS0dM1_tK = 2*pi*K*dS0dM1_delta_T;
dS1dM0_tK = 2*pi*K*dS1dM0_delta_T;
dS1dM1_tK = 2*pi*K*dS1dM1_delta_T;
%%%%;
dM0dS0_tK = 2*pi*K*dM0dS0_delta_T;
dM0dS1_tK = 2*pi*K*dM0dS1_delta_T;
dM1dS0_tK = 2*pi*K*dM1dS0_delta_T;
dM1dS1_tK = 2*pi*K*dM1dS1_delta_T;
%%%%;
dM0dM0_tK = 2*pi*K*dM0dM0_delta_T;
dM0dM1_tK = 2*pi*K*dM0dM1_delta_T;
dM1dM0_tK = 2*pi*K*dM1dM0_delta_T;
dM1dM1_tK = 2*pi*K*dM1dM1_delta_T;
%%%%;
end;%if flag_dd;
b0 = besselj(0,tK);
b2 = besselj(2,tK);
b4 = besselj(4,tK);
if flag_d;
dtK_b0 = 0.5*(besselj(0-1,tK) - besselj(0+1,tK)) ;
dtK_b2 = 0.5*(besselj(2-1,tK) - besselj(2+1,tK)) ;
dtK_b4 = 0.5*(besselj(4-1,tK) - besselj(4+1,tK)) ;
end;%if flag_d;
if flag_dd;
dtKdtK_b0 = 0.5*( 0.5*( besselj(0-1-1,tK) - besselj(0-1+1,tK) ) - 0.5*( besselj(0+1-1,tK) - besselj(0+1+1,tK) ) ) ;
dtKdtK_b2 = 0.5*( 0.5*( besselj(2-1-1,tK) - besselj(2-1+1,tK) ) - 0.5*( besselj(2+1-1,tK) - besselj(2+1+1,tK) ) ) ;
dtKdtK_b4 = 0.5*( 0.5*( besselj(4-1-1,tK) - besselj(4-1+1,tK) ) - 0.5*( besselj(4+1-1,tK) - besselj(4+1+1,tK) ) ) ;
end;%if flag_dd;
if flag_d;
dS0_b0 = dtK_b0 * dS0_tK ;
dS1_b0 = dtK_b0 * dS1_tK ;
dM0_b0 = dtK_b0 * dM0_tK ;
dM1_b0 = dtK_b0 * dM1_tK ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_b0 = dtKdtK_b0 * dS0_tK * dS0_tK + dtK_b0 * dS0dS0_tK ;
dS0dS1_b0 = dtKdtK_b0 * dS0_tK * dS1_tK + dtK_b0 * dS0dS1_tK ;
dS1dS0_b0 = dtKdtK_b0 * dS1_tK * dS0_tK + dtK_b0 * dS1dS0_tK ;
dS1dS1_b0 = dtKdtK_b0 * dS1_tK * dS1_tK + dtK_b0 * dS1dS1_tK ;
%%%%;
dS0dM0_b0 = dtKdtK_b0 * dS0_tK * dM0_tK + dtK_b0 * dS0dM0_tK ;
dS0dM1_b0 = dtKdtK_b0 * dS0_tK * dM1_tK + dtK_b0 * dS0dM1_tK ;
dS1dM0_b0 = dtKdtK_b0 * dS1_tK * dM0_tK + dtK_b0 * dS1dM0_tK ;
dS1dM1_b0 = dtKdtK_b0 * dS1_tK * dM1_tK + dtK_b0 * dS1dM1_tK ;
%%%%;
dM0dS0_b0 = dtKdtK_b0 * dM0_tK * dS0_tK + dtK_b0 * dM0dS0_tK ;
dM0dS1_b0 = dtKdtK_b0 * dM0_tK * dS1_tK + dtK_b0 * dM0dS1_tK ;
dM1dS0_b0 = dtKdtK_b0 * dM1_tK * dS0_tK + dtK_b0 * dM1dS0_tK ;
dM1dS1_b0 = dtKdtK_b0 * dM1_tK * dS1_tK + dtK_b0 * dM1dS1_tK ;
%%%%;
dM0dM0_b0 = dtKdtK_b0 * dM0_tK * dM0_tK + dtK_b0 * dM0dM0_tK ;
dM0dM1_b0 = dtKdtK_b0 * dM0_tK * dM1_tK + dtK_b0 * dM0dM1_tK ;
dM1dM0_b0 = dtKdtK_b0 * dM1_tK * dM0_tK + dtK_b0 * dM1dM0_tK ;
dM1dM1_b0 = dtKdtK_b0 * dM1_tK * dM1_tK + dtK_b0 * dM1dM1_tK ;
%%%%;
end;%if flag_dd;
if flag_d;
dS0_b2 = dtK_b2 * dS0_tK ;
dS1_b2 = dtK_b2 * dS1_tK ;
dM0_b2 = dtK_b2 * dM0_tK ;
dM1_b2 = dtK_b2 * dM1_tK ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_b2 = dtKdtK_b2 * dS0_tK * dS0_tK + dtK_b2 * dS0dS0_tK ;
dS0dS1_b2 = dtKdtK_b2 * dS0_tK * dS1_tK + dtK_b2 * dS0dS1_tK ;
dS1dS0_b2 = dtKdtK_b2 * dS1_tK * dS0_tK + dtK_b2 * dS1dS0_tK ;
dS1dS1_b2 = dtKdtK_b2 * dS1_tK * dS1_tK + dtK_b2 * dS1dS1_tK ;
%%%%;
dS0dM0_b2 = dtKdtK_b2 * dS0_tK * dM0_tK + dtK_b2 * dS0dM0_tK ;
dS0dM1_b2 = dtKdtK_b2 * dS0_tK * dM1_tK + dtK_b2 * dS0dM1_tK ;
dS1dM0_b2 = dtKdtK_b2 * dS1_tK * dM0_tK + dtK_b2 * dS1dM0_tK ;
dS1dM1_b2 = dtKdtK_b2 * dS1_tK * dM1_tK + dtK_b2 * dS1dM1_tK ;
%%%%;
dM0dS0_b2 = dtKdtK_b2 * dM0_tK * dS0_tK + dtK_b2 * dM0dS0_tK ;
dM0dS1_b2 = dtKdtK_b2 * dM0_tK * dS1_tK + dtK_b2 * dM0dS1_tK ;
dM1dS0_b2 = dtKdtK_b2 * dM1_tK * dS0_tK + dtK_b2 * dM1dS0_tK ;
dM1dS1_b2 = dtKdtK_b2 * dM1_tK * dS1_tK + dtK_b2 * dM1dS1_tK ;
%%%%;
dM0dM0_b2 = dtKdtK_b2 * dM0_tK * dM0_tK + dtK_b2 * dM0dM0_tK ;
dM0dM1_b2 = dtKdtK_b2 * dM0_tK * dM1_tK + dtK_b2 * dM0dM1_tK ;
dM1dM0_b2 = dtKdtK_b2 * dM1_tK * dM0_tK + dtK_b2 * dM1dM0_tK ;
dM1dM1_b2 = dtKdtK_b2 * dM1_tK * dM1_tK + dtK_b2 * dM1dM1_tK ;
%%%%;
end;%if flag_dd;
if flag_d;
dS0_b4 = dtK_b4 * dS0_tK ;
dS1_b4 = dtK_b4 * dS1_tK ;
dM0_b4 = dtK_b4 * dM0_tK ;
dM1_b4 = dtK_b4 * dM1_tK ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_b4 = dtKdtK_b4 * dS0_tK * dS0_tK + dtK_b4 * dS0dS0_tK ;
dS0dS1_b4 = dtKdtK_b4 * dS0_tK * dS1_tK + dtK_b4 * dS0dS1_tK ;
dS1dS0_b4 = dtKdtK_b4 * dS1_tK * dS0_tK + dtK_b4 * dS1dS0_tK ;
dS1dS1_b4 = dtKdtK_b4 * dS1_tK * dS1_tK + dtK_b4 * dS1dS1_tK ;
%%%%;
dS0dM0_b4 = dtKdtK_b4 * dS0_tK * dM0_tK + dtK_b4 * dS0dM0_tK ;
dS0dM1_b4 = dtKdtK_b4 * dS0_tK * dM1_tK + dtK_b4 * dS0dM1_tK ;
dS1dM0_b4 = dtKdtK_b4 * dS1_tK * dM0_tK + dtK_b4 * dS1dM0_tK ;
dS1dM1_b4 = dtKdtK_b4 * dS1_tK * dM1_tK + dtK_b4 * dS1dM1_tK ;
%%%%;
dM0dS0_b4 = dtKdtK_b4 * dM0_tK * dS0_tK + dtK_b4 * dM0dS0_tK ;
dM0dS1_b4 = dtKdtK_b4 * dM0_tK * dS1_tK + dtK_b4 * dM0dS1_tK ;
dM1dS0_b4 = dtKdtK_b4 * dM1_tK * dS0_tK + dtK_b4 * dM1dS0_tK ;
dM1dS1_b4 = dtKdtK_b4 * dM1_tK * dS1_tK + dtK_b4 * dM1dS1_tK ;
%%%%;
dM0dM0_b4 = dtKdtK_b4 * dM0_tK * dM0_tK + dtK_b4 * dM0dM0_tK ;
dM0dM1_b4 = dtKdtK_b4 * dM0_tK * dM1_tK + dtK_b4 * dM0dM1_tK ;
dM1dM0_b4 = dtKdtK_b4 * dM1_tK * dM0_tK + dtK_b4 * dM1dM0_tK ;
dM1dM1_b4 = dtKdtK_b4 * dM1_tK * dM1_tK + dtK_b4 * dM1dM1_tK ;
%%%%;
end;%if flag_dd;
%mode_2 = ( -4*pi*cos(phi_p - 2*omega_T) * K^3 * besselj(3,tK) ) / t ;
%mode_2 = -4*pi*cos(phi_p - 2*omega_T) * K^4 * ( besselj(2,tK) + besselj(4,tK) ) / 6;
mode_2 = -4*pi*cos(phi_p - 2*omega_T) * K^4 * ( + b2 + b4 )/6;
if flag_d;
dS0_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS0_b4 )/6 ...
;
dS1_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS1_b4 )/6 ...
;
dM0_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM0_b4 )/6 ...
;
dM1_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM1_b4 )/6 ...
;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS0_b4 )/6 ...
;
dS0dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS1_b4 )/6 ...
;
dS1dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS0_b4 )/6 ...
;
dS1dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS1_b4 )/6 ...
;
%%%%;
dS0dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM0_b4 )/6 ...
;
dS0dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM1_b4 )/6 ...
;
dS1dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM0_b4 )/6 ...
;
dS1dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM1_b4 )/6 ...
;
%%%%;
dM0dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS0_b4 )/6 ...
;
dM0dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS1_b4 )/6 ...
;
dM1dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS0_b4 )/6 ...
;
dM1dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS1_b4 )/6 ...
;
%%%%;
dM0dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM0_b4 )/6 ...
;
dM0dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM1_b4 )/6 ...
;
dM1dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM0_b4 )/6 ...
;
dM1dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM1_b4 )/6 ...
;
%%%%;
end;%if flag_dd;
%mode_0 = 4*pi*cos(phi_n) * ( tK^3 * besselj(1,tK) - 2*tK^2 *besselj(2,tK) ) / t^4 ;
%mode_0 = 4*pi*cos(phi_n) * K^4 * ( besselj(0,tK)/4 + besselj(2,tK)/6 - besselj(4,tK)/12 ) ;
mode_0 = 4*pi*cos(phi_n) * K^4 * ( b0/4 + b2/6 - b4/12 );
if flag_d;
dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0_b4/12 ) ...
;
dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1_b4/12 ) ...
;
dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0_b4/12 ) ...
;
dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1_b4/12 ) ...
;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dS0_b4/12 ) ...
;
dS0dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dS1_b4/12 ) ...
;
dS1dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dS0_b4/12 ) ...
;
dS1dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dS1_b4/12 ) ...
;
%%%%;
dS0dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dM0_b4/12 ) ...
;
dS0dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dM1_b4/12 ) ...
;
dS1dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dM0_b4/12 ) ...
;
dS1dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dM1_b4/12 ) ...
;
%%%%;
dM0dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dS0_b4/12 ) ...
;
dM0dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dS1_b4/12 ) ...
;
dM1dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dS0_b4/12 ) ...
;
dM1dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dS1_b4/12 ) ...
;
%%%%;
dM0dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dM0_b4/12 ) ...
;
dM0dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dM1_b4/12 ) ...
;
dM1dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dM0_b4/12 ) ...
;
dM1dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dM1_b4/12 ) ...
;
%%%%;
end;%if flag_dd;
output = mode_0 + mode_2 ;
if flag_d
dS0_output = dS0_mode_0 + dS0_mode_2 ;
dS1_output = dS1_mode_0 + dS1_mode_2 ;
dM0_output = dM0_mode_0 + dM0_mode_2 ;
dM1_output = dM1_mode_0 + dM1_mode_2 ;
end;%if flag_d
if flag_dd;
%%%%;
dS0dS0_output = dS0dS0_mode_0 + dS0dS0_mode_2 ;
dS0dS1_output = dS0dS1_mode_0 + dS0dS1_mode_2 ;
dS1dS0_output = dS1dS0_mode_0 + dS1dS0_mode_2 ;
dS1dS1_output = dS1dS1_mode_0 + dS1dS1_mode_2 ;
%%%%;
dS0dM0_output = dS0dM0_mode_0 + dS0dM0_mode_2 ;
dS0dM1_output = dS0dM1_mode_0 + dS0dM1_mode_2 ;
dS1dM0_output = dS1dM0_mode_0 + dS1dM0_mode_2 ;
dS1dM1_output = dS1dM1_mode_0 + dS1dM1_mode_2 ;
%%%%;
dM0dS0_output = dM0dS0_mode_0 + dM0dS0_mode_2 ;
dM0dS1_output = dM0dS1_mode_0 + dM0dS1_mode_2 ;
dM1dS0_output = dM1dS0_mode_0 + dM1dS0_mode_2 ;
dM1dS1_output = dM1dS1_mode_0 + dM1dS1_mode_2 ;
%%%%;
dM0dM0_output = dM0dM0_mode_0 + dM0dM0_mode_2 ;
dM0dM1_output = dM0dM1_mode_0 + dM0dM1_mode_2 ;
dM1dM0_output = dM1dM0_mode_0 + dM1dM0_mode_2 ;
dM1dM1_output = dM1dM1_mode_0 + dM1dM1_mode_2 ;
%%%%;
end;%if flag_dd;

flag_check=0;
if flag_check;
if flag_dd;
%%%%;
disp(sprintf(' %% checking mixed partials: dS0dS1'));
disp(sprintf(' %% delta_T: %+0.6f',dS0dS1_delta_T - dS1dS0_delta_T));
disp(sprintf(' %% omega_T: %+0.6f',dS0dS1_omega_T - dS1dS0_omega_T));
disp(sprintf(' %% tK: %+0.6f',dS0dS1_tK - dS1dS0_tK));
disp(sprintf(' %% b0: %+0.6f',dS0dS1_b0 - dS1dS0_b0));
disp(sprintf(' %% b2: %+0.6f',dS0dS1_b2 - dS1dS0_b2));
disp(sprintf(' %% b4: %+0.6f',dS0dS1_b4 - dS1dS0_b4));
disp(sprintf(' %% mode_0: %+0.6f',dS0dS1_mode_0 - dS1dS0_mode_0));
disp(sprintf(' %% mode_2: %+0.6f',dS0dS1_mode_2 - dS1dS0_mode_2));
disp(sprintf(' %% output: %+0.6f',dS0dS1_output - dS1dS0_output));
%%%%;
disp(sprintf(' %% checking mixed partials: dS0dM0'));
disp(sprintf(' %% delta_T: %+0.6f',dS0dM0_delta_T - dM0dS0_delta_T));
disp(sprintf(' %% omega_T: %+0.6f',dS0dM0_omega_T - dM0dS0_omega_T));
disp(sprintf(' %% tK: %+0.6f',dS0dM0_tK - dM0dS0_tK));
disp(sprintf(' %% b0: %+0.6f',dS0dM0_b0 - dM0dS0_b0));
disp(sprintf(' %% b2: %+0.6f',dS0dM0_b2 - dM0dS0_b2));
disp(sprintf(' %% b4: %+0.6f',dS0dM0_b4 - dM0dS0_b4));
disp(sprintf(' %% mode_0: %+0.6f',dS0dM0_mode_0 - dM0dS0_mode_0));
disp(sprintf(' %% mode_2: %+0.6f',dS0dM0_mode_2 - dM0dS0_mode_2));
disp(sprintf(' %% output: %+0.6f',dS0dM0_output - dM0dS0_output));
%%%%;
disp(sprintf(' %% checking mixed partials: dS0dM1'));
disp(sprintf(' %% delta_T: %+0.6f',dS0dM1_delta_T - dM1dS0_delta_T));
disp(sprintf(' %% omega_T: %+0.6f',dS0dM1_omega_T - dM1dS0_omega_T));
disp(sprintf(' %% tK: %+0.6f',dS0dM1_tK - dM1dS0_tK));
disp(sprintf(' %% b0: %+0.6f',dS0dM1_b0 - dM1dS0_b0));
disp(sprintf(' %% b2: %+0.6f',dS0dM1_b2 - dM1dS0_b2));
disp(sprintf(' %% b4: %+0.6f',dS0dM1_b4 - dM1dS0_b4));
disp(sprintf(' %% mode_0: %+0.6f',dS0dM1_mode_0 - dM1dS0_mode_0));
disp(sprintf(' %% mode_2: %+0.6f',dS0dM1_mode_2 - dM1dS0_mode_2));
disp(sprintf(' %% output: %+0.6f',dS0dM1_output - dM1dS0_output));
%%%%;
disp(sprintf(' %% checking mixed partials: dS1dM0'));
disp(sprintf(' %% delta_T: %+0.6f',dS1dM0_delta_T - dM0dS1_delta_T));
disp(sprintf(' %% omega_T: %+0.6f',dS1dM0_omega_T - dM0dS1_omega_T));
disp(sprintf(' %% tK: %+0.6f',dS1dM0_tK - dM0dS1_tK));
disp(sprintf(' %% b0: %+0.6f',dS1dM0_b0 - dM0dS1_b0));
disp(sprintf(' %% b2: %+0.6f',dS1dM0_b2 - dM0dS1_b2));
disp(sprintf(' %% b4: %+0.6f',dS1dM0_b4 - dM0dS1_b4));
disp(sprintf(' %% mode_0: %+0.6f',dS1dM0_mode_0 - dM0dS1_mode_0));
disp(sprintf(' %% mode_2: %+0.6f',dS1dM0_mode_2 - dM0dS1_mode_2));
disp(sprintf(' %% output: %+0.6f',dS1dM0_output - dM0dS1_output));
%%%%;
disp(sprintf(' %% checking mixed partials: dS1dM1'));
disp(sprintf(' %% delta_T: %+0.6f',dS1dM1_delta_T - dM1dS1_delta_T));
disp(sprintf(' %% omega_T: %+0.6f',dS1dM1_omega_T - dM1dS1_omega_T));
disp(sprintf(' %% tK: %+0.6f',dS1dM1_tK - dM1dS1_tK));
disp(sprintf(' %% b0: %+0.6f',dS1dM1_b0 - dM1dS1_b0));
disp(sprintf(' %% b2: %+0.6f',dS1dM1_b2 - dM1dS1_b2));
disp(sprintf(' %% b4: %+0.6f',dS1dM1_b4 - dM1dS1_b4));
disp(sprintf(' %% mode_0: %+0.6f',dS1dM1_mode_0 - dM1dS1_mode_0));
disp(sprintf(' %% mode_2: %+0.6f',dS1dM1_mode_2 - dM1dS1_mode_2));
disp(sprintf(' %% output: %+0.6f',dS1dM1_output - dM1dS1_output));
%%%%;
disp(sprintf(' %% checking mixed partials: dM0dM1'));
disp(sprintf(' %% delta_T: %+0.6f',dM0dM1_delta_T - dM1dM0_delta_T));
disp(sprintf(' %% omega_T: %+0.6f',dM0dM1_omega_T - dM1dM0_omega_T));
disp(sprintf(' %% tK: %+0.6f',dM0dM1_tK - dM1dM0_tK));
disp(sprintf(' %% b0: %+0.6f',dM0dM1_b0 - dM1dM0_b0));
disp(sprintf(' %% b2: %+0.6f',dM0dM1_b2 - dM1dM0_b2));
disp(sprintf(' %% b4: %+0.6f',dM0dM1_b4 - dM1dM0_b4));
disp(sprintf(' %% mode_0: %+0.6f',dM0dM1_mode_0 - dM1dM0_mode_0));
disp(sprintf(' %% mode_2: %+0.6f',dM0dM1_mode_2 - dM1dM0_mode_2));
disp(sprintf(' %% output: %+0.6f',dM0dM1_output - dM1dM0_output));
%%%%;
end;%if flag_dd;
end;%if flag_check;
