addpath('/data/rangan/dir_cryoem/chebfun');
n_figure = 1;
for K = [16:4:128];
K_ = -K:K; n_K = length(K_); 
%c_ = 1./(1+abs(K_)).^0.125;
c_ = 1 + mod(K_,16)/16;
f_ = @(x_,c_,K_) cos(1*pi*x_(:)*transpose(K_(:)))*c_(:);
I_x = 2.0;
x_ = linspace(-1,+1,512);
Q_ = 1:n_K+16; n_Q = length(Q_);
I_ = zeros(n_Q,1);
E_ = zeros(n_Q,1);
for nQ=1:n_Q;
[s_,w_] = legpts(Q_(nQ));
I_(nQ) = w_*f_(s_,c_,K_);
E_(nQ) = abs(I_x - I_(nQ))./I_x;
end;%for nQ=1:n_Q;
figure(n_figure);
subplot(1,3,1);hold on; plot(x_,f_(x_,c_,K_));
subplot(1,3,2);hold on; plot(Q_,I_,'k.-'); % title(sprintf('K=%d',K));
xlabel('nQ');ylabel('I');
xlim([min(Q_),max(Q_)]);
subplot(1,3,3);hold on; plot(Q_,log10(E_),'k.-');
xlabel('nQ');ylabel('log10(E)');
xlim([min(Q_),max(Q_)]);
set(gcf,'Position',1+[0,0,512*3,512*1]);
end;%for K = [16,32,48,64]; 
