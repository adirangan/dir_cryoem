% testing bessel-function properties ; 
ng = 1024;
z_ = linspace(0,5,16);
for nz=1:length(z_);
t = linspace(-pi,pi,ng); k = -ng/2:ng/2-1;
z = z_(nz);
f1 = fft(exp(-i*transpose(z)*cos(t)))/(2*pi)/sqrt(ng); f1 = f1(:,[end/2+1:end , 1:end/2]);
f2 = fft(exp(-i*transpose(z)*sin(t)))/(2*pi)/sqrt(ng); f2 = f2(:,[end/2+1:end , 1:end/2]);
%f1 = fft(cos(transpose(z)*sin(t)))/(2*pi)/sqrt(ng); f1 = f1(:,[end/2+1:end , 1:end/2]);
%f2 = fft(sin(transpose(z)*sin(t)))/(2*pi)/sqrt(ng); f2 = f2(:,[end/2+1:end , 1:end/2]);
[K,Z] = meshgrid(k,z);
J = besselj(K,Z)*(2*pi);
A = 1./sqrt(2*pi*K) .* (exp(1) .* Z ./ K / 2).^K *(2*pi); 
subplot(ceil(sqrt(length(z_))),ceil(sqrt(length(z_))),nz);
hold on; 
kl = ng/2+1+[0:32];
%plot(kl,log10(abs(transpose(f(kl)))),'k-');
plot(kl,log10(abs(transpose(f1(kl)))),'k-');
plot(kl,log10(abs(transpose(f2(kl)))),'m-');
plot(kl,log10(abs(transpose(J(kl)))),'b.-');
plot(kl,log10(abs(transpose(A(kl)))),'r-');
xlim([kl(1),kl(end)]); ylim([-3,+1]); title(sprintf('z=%0.2f',z));
hold off;
end;%for nz=1:length(z_);
