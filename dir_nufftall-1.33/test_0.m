rng(1);
n_x = 1024*8; 
x_ = linspace(0,2*pi,n_x+1); x_ = x_(1:n_x);
%c_ = exp(2*i*x_);
c_ = randn(size(x_));
i_flag = -1; 
m_s = n_x; 
tic(); f_d_ = dirft1d1(n_x,x_,c_,i_flag,m_s); t_d = toc();
tic(); f_r_ = fft(c_)/n_x; t_r = toc(); f_r_ = reshape(f_r_,size(f_d_));
eps_ = 0.1.^[1:15];
l2_error_ = zeros(length(eps_),1);
t_n_ = zeros(length(eps_),1);
for ne=1:length(eps_);
eps = eps_(ne);
tic();f_n_ = nufft1d1(n_x,x_,c_,i_flag,eps,m_s); t_n_(ne) = toc();
l2_error_(ne) = norm(f_d_ - f_n_);
end;%for ne=1:length(eps_);
disp_flag=1;
if disp_flag;
subplot(1,2,1);
plot(log10(eps_),log10(l2_error_),'.-');
xlabel('log10(eps)'); ylabel('log10(error)');
subplot(1,2,2); hold on; 
plot(log10(eps_),t_n_,'.-'); 
plot(log10(eps_),t_r*ones(size(eps_)),'k-'); 
plot(log10(eps_),t_d*ones(size(eps_)),'r-'); 
hold off;
xlim([-15,0]); ylim([0,max(t_r,max(t_n_))]);
xlabel('log10(eps)'); ylabel('t_n');
end;%if disp_flag;
