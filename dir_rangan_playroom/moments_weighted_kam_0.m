function ...
[ ...
output_vector_ ...
] = ...
moments_weighted_kam_0( ...
 n_lm_sum ...
,a_k_Y_ ...
,n_gamma ...
,moment_0_lm0_ ...
,moment_1_lm0lm1g___ ...
,moment_2_lm1lm2lm0gg_____ ...
,moment_weight_ ...
);
%%%%%%%%;
S_func_moment_0 = 0;
for nlm0=0:n_lm_sum-1;
S_func_moment_0 = S_func_moment_0 + a_k_Y_(1+nlm0)*moment_0_lm0_(1+nlm0);
end;%for nlm0=0:n_lm_sum-1;
%%%%%%%%;
S_func_moment_1_g_ = zeros(n_gamma,1);
for ngamma1=0:n_gamma-1;
S_func_moment_1_g_(1+ngamma1) = S_func_moment_1_g_(1+ngamma1) + ctranspose(a_k_Y_)*reshape(moment_1_lm0lm1g___(:,:,1+ngamma1),[n_lm_sum,n_lm_sum])*a_k_Y_;
end;%for ngamma1=0:n_gamma-1;
%%%%%%%%;
S_func_moment_2_gg__ = zeros(n_gamma,n_gamma);
for ngamma1=0:n_gamma-1;
for ngamma2=0:n_gamma-1;
for nlm0=0:n_lm_sum-1;
S_func_moment_2_gg__(1+ngamma1,1+ngamma2) = S_func_moment_2_gg__(1+ngamma1,1+ngamma2) + conj(a_k_Y_(1+nlm0))* ( transpose(a_k_Y_)*reshape(moment_2_lm1lm2lm0gg_____(:,:,1+nlm0,1+ngamma1,1+ngamma2),[n_lm_sum,n_lm_sum])*a_k_Y_ );
end;%for nlm0=0:n_lm_sum-1;
end;%for ngamma2=0:n_gamma-1;
end;%for ngamma1=0:n_gamma-1;

output_vector_ = ...
[ ...
   S_func_moment_0*moment_weight_(1+0) ...
 ; S_func_moment_1_g_(:)*moment_weight_(1+1) ...
 ; S_func_moment_2_gg__(:)*moment_weight_(1+2) ...
];
