N = 128;
[X,Y] = meshgrid(linspace(-1,1,N));
R = sqrt(X.^2+Y.^2);W = atan2(Y,X);
sigma_E = 1/4; eccentricity = 10;
omega_E = pi/4; cw = cos(omega_E); sw = sin(omega_E); 
rw = [cw +sw ; -sw cw] ; rm = [cw -sw ; +sw cw]; 
dw = (1/sigma_E).*[ 1 0 ; 0 sqrt(eccentricity/1) ]; 
dm = (sigma_E/1).*[ 1 0 ; 0 sqrt(1/eccentricity) ]; 
C = dw * rm ;
Xt = C(1).*X + C(3).*Y; Yt = C(2).*X + C(4).*Y; 
E1 = Xt.*Xt + Yt.*Yt;
C = rw * dw * dw * rm;
E2 = X.*C(1).*X + X.*C(3).*Y + Y.*C(2).*X + Y.*C(4).*Y; 
disp(sprintf(' %% norm E1-E2 %f',norm(E1-E2)));
tau_G = 10;
Rt = sqrt(Xt.^2 + Yt.^2)/tau_G;
omega_G = 5;
G1 = exp(-Rt).*sin(min(pi,2*pi*omega_G*Rt.^2));
F = exp(-E1).*G1;
%F = exp(-E1);
K = recenter2(fft2(recenter2(F)));
subplot(2,2,1); imagesc(F); axis square; colorbar; 
subplot(2,2,2); imagesc(real(K)); axis square; colorbar;
subplot(2,2,3); imagesc(imag(K)); axis square; colorbar;
subplot(2,2,4); imagesc(abs(K)); axis square; colorbar;
