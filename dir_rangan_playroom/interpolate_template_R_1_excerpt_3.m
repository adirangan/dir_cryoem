tab_a = 0; tab_b = 1; tab_c = 2;
tab_0 = 0; tab_1 = 1; tab_2 = 2;
%%%%%%%%;
tmp_t = tic();
H_ori_abcabc012wT____ = ...
  reshape( ...
	   permute( ...
		    cat( ...
			 5 ...
			 ,dtau_dtau_k_c_0_wTabcabc____ ...
			 ,dtau_dtau_k_c_1_wTabcabc____ ...
			 ,dtau_dtau_k_c_2_wTabcabc____ ...
			 ) ...
		    ,[3,4,5,1,2] ...
		    ) ...
	   ,[n_9,n_3,n_w_max,n_T] ...
	   );
H_ori_abcabc012012wT____ = ...
  reshape( ...
	   bsxfun(@times ...
		  ,reshape(J_ori_abc012wT____,[n_3,n_1,n_3,n_1,n_w_max,n_T]) ...
		  ,reshape(J_ori_abc012wT____,[n_1,n_3,n_1,n_3,n_w_max,n_T]) ...
		  ) ...
	   ,[n_9,n_9,n_w_max,n_T] ...
	   );
H_rot_abcabc012wT____ = ...
  reshape( ...
	   permute( ...
		    cat( ...
			 5 ...
			 ,dtau_dtau_R_k_c_0_wTabcabc____ ...
			 ,dtau_dtau_R_k_c_1_wTabcabc____ ...
			 ,dtau_dtau_R_k_c_2_wTabcabc____ ...
			 ) ...
		    ,[3,4,5,1,2] ...
		    ) ...
	   ,[n_9,n_3,n_w_max,n_T] ...
	   );
H_rot_abcabc012012wT____ = ...
  reshape( ...
	   bsxfun(@times ...
		  ,reshape(J_rot_abc012wT____,[n_3,n_1,n_3,n_1,n_w_max,n_T]) ...
		  ,reshape(J_rot_abc012wT____,[n_1,n_3,n_1,n_3,n_w_max,n_T]) ...
		  ) ...
	   ,[n_9,n_9,n_w_max,n_T] ...
	   );
tmp_t = toc(tmp_t); if (flag_verbose>0); disp(sprintf(' %% H_xxx_abcabc012012wT____: time %0.6fs',tmp_t)); end;
%%%%%%%%;
tmp_t = tic();
[~,pinv_H_ori_abcabc012012wT____] = pagepinv_0(struct('tolerance_pinv',tolerance_pinv),H_ori_abcabc012012wT____);
[~,pinv_H_rot_abcabc012012wT____] = pagepinv_0(struct('tolerance_pinv',tolerance_pinv),H_rot_abcabc012012wT____);
tmp_t = toc(tmp_t); if (flag_verbose>0); disp(sprintf(' %% pinv_H_xxx_abcabc012012wT____: time %0.6fs',tmp_t)); end;
%%%%%%%%;
tmp_t = tic();
ddtemplatedabcabc_ori_abcabc1wkT_____ = reshape(permute(cat(4,ddtemplatedaa_ori_wkT__,ddtemplatedab_ori_wkT__,ddtemplatedac_ori_wkT__,ddtemplatedba_ori_wkT__,ddtemplatedbb_ori_wkT__,ddtemplatedbc_ori_wkT__,ddtemplatedca_ori_wkT__,ddtemplatedcb_ori_wkT__,ddtemplatedcc_ori_wkT__),[3,4,1,2]),[n_9,n_1,n_w_max,n_k_p_r,n_T]);
RHS_ori_abcabc1wkT_____ = ddtemplatedabcabc_ori_abcabc1wkT_____ - pagemtimes(reshape(H_ori_abcabc012wT____,[n_9,n_3,n_w_max,1,n_T]),dtemplated012_ori_0121wkT_____) ;
LHS_ori_0120121wkT_____ = pagemtimes(reshape(pinv_H_ori_abcabc012012wT____,[n_9,n_9,n_w_max,1,n_T]),RHS_ori_abcabc1wkT_____);
%%%%;
ddtemplatedabcabc_rot_abcabc1wkT_____ = reshape(permute(cat(4,ddtemplatedaa_rot_wkT__,ddtemplatedab_rot_wkT__,ddtemplatedac_rot_wkT__,ddtemplatedba_rot_wkT__,ddtemplatedbb_rot_wkT__,ddtemplatedbc_rot_wkT__,ddtemplatedca_rot_wkT__,ddtemplatedcb_rot_wkT__,ddtemplatedcc_rot_wkT__),[3,4,1,2]),[n_9,n_1,n_w_max,n_k_p_r,n_T]);
RHS_rot_abcabc1wkT_____ = ddtemplatedabcabc_rot_abcabc1wkT_____ - pagemtimes(reshape(H_rot_abcabc012wT____,[n_9,n_3,n_w_max,1,n_T]),dtemplated012_rot_0121wkT_____) ;
LHS_rot_0120121wkT_____ = pagemtimes(reshape(pinv_H_rot_abcabc012012wT____,[n_9,n_9,n_w_max,1,n_T]),RHS_rot_abcabc1wkT_____);
%%%%;
LHS_ori_012012wkT_____ = reshape(LHS_ori_0120121wkT_____,[n_3,n_3,n_w_max,n_k_p_r,n_T]);
LHS_rot_012012wkT_____ = reshape(LHS_rot_0120121wkT_____,[n_3,n_3,n_w_max,n_k_p_r,n_T]);
LHS_rec_012012wkT_____ = pagemtimes(pagemtimes(R_use__,LHS_rot_012012wkT_____),transpose(R_use__));
LHS_rec_0120121wkT_____ = reshape(LHS_rec_012012wkT_____,[n_9,n_1,n_w_max,n_k_p_r,n_T]);
%%%%;
if flag_verbose>2;
fnorm_disp(flag_verbose,'LHS_rec_012012wkT_____',LHS_rec_012012wkT_____,'LHS_rot_012012wkT_____',LHS_rot_012012wkT_____); %<-- note that this will be large for those nT corresponding to a poorly-conditioned change-of-variables. ;
end;%if flag_verbose>2;
%%%%;
ddtemplatedabcabc_rec_abcabc1wkT_____ = ...
 + pagemtimes(reshape(H_ori_abcabc012wT____,[n_9,n_3,n_w_max,n_1,n_T]),dtemplated012_rec_0121wkT_____) ...
 + pagemtimes(reshape(H_ori_abcabc012012wT____,[n_9,n_9,n_w_max,n_1,n_T]),LHS_rec_0120121wkT_____) ...
;
ddtemplatedabcabc_rec_abcabcwkT_____ = reshape(ddtemplatedabcabc_rec_abcabc1wkT_____,[n_3,n_3,n_w_max,n_k_p_r,n_T]);
ddtemplatedabcabc_rec_abcabcwkT_____ = 0.5*(ddtemplatedabcabc_rec_abcabcwkT_____ + pagetranspose(ddtemplatedabcabc_rec_abcabcwkT_____));
%%%%;
ddtemplatedabcabc_rec_wkTabcabc____ = reshape(permute(ddtemplatedabcabc_rec_abcabcwkT_____,[3,4,5,1,2]),[n_w_sum,n_T,n_3,n_3]);
ddtemplatedaa_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_a,1+tab_a);
ddtemplatedab_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_a,1+tab_b);
ddtemplatedac_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_a,1+tab_c);
%ddtemplatedba_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_b,1+tab_a);
ddtemplatedbb_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_b,1+tab_b);
ddtemplatedbc_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_b,1+tab_c);
%ddtemplatedca_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_c,1+tab_a);
%ddtemplatedcb_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_c,1+tab_b);
ddtemplatedcc_rec_wkT__ = ddtemplatedabcabc_rec_wkTabcabc____(:,:,1+tab_c,1+tab_c);
%%%%;
tmp_t = toc(tmp_t); if (flag_verbose>0); disp(sprintf(' %% ddtemplatedxx_rec_wkT__: time %0.6fs',tmp_t)); end;
