function ...
[ ...
 a_k_Y_ ...
 a_k_p_ ...
] = ...
convert_x_c_to_spharm_1( ...
 verbose ...
,n_k_all ...
,n_k_all_csum_ ...
,k_p_r_all_ ...
,k_p_azimu_b_all_ ...
,k_p_polar_a_all_ ...
,weight_3d_k_all_ ...
,weight_shell_k_ ...
,n_k_p_r ...
,k_p_r_ ...
,weight_3d_k_p_r_ ...
,k_p_r_max ...
,l_max_ ...
,n_xxx_c ...
,xxx_c_weight_ ...
,x_c_0___ ...
,x_c_1___ ...
,x_c_2___ ...
,x_p_r_max ...
,a_x_c_ ...
);

na=0;
if (nargin<1+na); verbose=[]; end; na=na+1;
if (nargin<1+na); n_k_all=[]; end; na=na+1;
if (nargin<1+na); n_k_all_csum_=[]; end; na=na+1;
if (nargin<1+na); k_p_r_all_=[]; end; na=na+1;
if (nargin<1+na); k_p_azimu_b_all_=[]; end; na=na+1;
if (nargin<1+na); k_p_polar_a_all_=[]; end; na=na+1;
if (nargin<1+na); weight_3d_k_all_=[]; end; na=na+1;
if (nargin<1+na); weight_shell_k_=[]; end; na=na+1;
if (nargin<1+na); n_k_p_r=[]; end; na=na+1;
if (nargin<1+na); k_p_r_=[]; end; na=na+1;
if (nargin<1+na); weight_3d_k_p_r_=[]; end; na=na+1;
if (nargin<1+na); k_p_r_max=[]; end; na=na+1;
if (nargin<1+na); l_max_=[]; end; na=na+1;
if (nargin<1+na); n_xxx_c=[]; end; na=na+1;
if (nargin<1+na); xxx_c_weight_=[]; end; na=na+1;
if (nargin<1+na); x_c_0___=[]; end; na=na+1;
if (nargin<1+na); x_c_1___=[]; end; na=na+1;
if (nargin<1+na); x_c_2___=[]; end; na=na+1;
if (nargin<1+na); x_p_r_max=[]; end; na=na+1;
if (nargin<1+na); a_x_c_=[]; end; na=na+1;

if isempty(x_p_r_max); x_p_r_max = 1.0; end;
if isempty(n_xxx_c); n_xxx_c = numel(x_c_0___); end;
assert(numel(a_x_c_)==n_xxx_c);
assert(numel(x_c_0___)==n_xxx_c);
assert(numel(x_c_1___)==n_xxx_c);
assert(numel(x_c_2___)==n_xxx_c);

k_c_0_all_ = k_p_r_all_ .* sin(k_p_polar_a_all_) .* cos(k_p_azimu_b_all_);
k_c_1_all_ = k_p_r_all_ .* sin(k_p_polar_a_all_) .* sin(k_p_azimu_b_all_);
k_c_2_all_ = k_p_r_all_ .* cos(k_p_polar_a_all_) ;

tmp_t = tic;
[ ...
 a_k_p_ ...
] = ...
convert_x_c_to_k_p_1( ...
 verbose ...
,n_k_all ...
,weight_3d_k_all_ ...
,k_c_0_all_ ...
,k_c_1_all_ ...
,k_c_2_all_ ...
,k_p_r_max ...
,n_xxx_c ...
,xxx_c_weight_ ...
,x_c_0___ ...
,x_c_1___ ...
,x_c_2___ ...
,x_p_r_max ...
,a_x_c_ ...
);
tmp_t = toc(tmp_t);
if (verbose); disp(sprintf(' %% a_x_c_ to a_k_p_: %0.2fs',tmp_t)); end;

tmp_t = tic;
[a_k_Y_] = ...
convert_k_p_to_spharm_1( ...
 verbose ...
,n_k_all ...
,n_k_all_csum_ ...
,k_p_r_all_ ...
,k_p_azimu_b_all_ ...
,k_p_polar_a_all_ ...
,weight_3d_k_all_ ...
,weight_shell_k_ ...
,n_k_p_r ...
,k_p_r_ ...
,weight_3d_k_p_r_ ...
,l_max_ ...
,a_k_p_ ...
);
tmp_t = toc(tmp_t);
if (verbose); disp(sprintf(' %% a_x_c_ to a_k_p_: %0.2fs',tmp_t)); end;

