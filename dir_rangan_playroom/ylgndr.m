function y__ = ylgndr(l_max,x);
% Note that this returns: ;
% y__(1+l_val,1+m_val) ; 
% such that ;
% y__(1+l_val,1+m_val) == Y__(1+l_val,1+m_val), where: ;
% Y__ is constructed via: ;
% m_val_=transpose(0:l_val);
% tmp_a1 = ((1+2*l_val)/(4*pi));
% tmp_a2_ = factorial(l_val-abs(m_val_))./factorial(l_val+abs(m_val_));
% tmp_a3_ = sqrt(tmp_a1*tmp_a2_);
% Y__(1+l_val,:) = legendre(l_val,x,'unnorm').*tmp_a3_*sqrt(4*pi);

if (nargin<2);
l_max = 4;
x = 0.125;
tmp_y_fortran__ = ylgndr(l_max,x);
tmp_Y_matlab__ = zeros(1+l_max,1+l_max);
for l_val=0:l_max;
m_val_ = transpose(0:l_val);
tmp_a1 = ((1+2*l_val)/(4*pi));
tmp_a2_ = exp(lfactorial(l_val-abs(m_val_)) - lfactorial(l_val+abs(m_val_)));
tmp_a3_ = sqrt(tmp_a1*tmp_a2_);
tmp_Y_matlab__(1+l_val,1:(1+l_val)) = legendre(l_val,x,'unnorm').*tmp_a3_;
end;%for l_val=0:l_max;
disp(sprintf(' %% tmp_y_fortran__ vs sqrt(4*pi)*tmp_Y_matlab__: %0.16f',fnorm(tmp_y_fortran__-sqrt(4*pi)*tmp_Y_matlab__)/fnorm(tmp_y_fortran__)));
l_max = 96; n_x = 1024*2;
x_ = rand(n_x,1);
tmp_t = tic;
for nx=1:n_x;
ylgndr(l_max,x_(nx));
end;%for nx=1:n_x;
tmp_t = toc(tmp_t); disp(sprintf(' %% y_fortran__: %0.2fs',tmp_t));
tmp_t = tic;
for l_val=0:l_max;
m_val_ = transpose(0:l_val);
tmp_a1 = ((1+2*l_val)/(4*pi));
tmp_a2_ = exp(lfactorial(l_val-abs(m_val_)) - lfactorial(l_val+abs(m_val_)));
tmp_a3_ = sqrt(tmp_a1*tmp_a2_);
legendre(l_val,x_,'unnorm').*tmp_a3_;
end;%for l_val=0:l_max;
tmp_t = toc(tmp_t); disp(sprintf(' %% Y_matlab__: %0.2fs',tmp_t));
disp('returning'); return;
end;%if (nargin<2);

u = -sqrt((1-x)*(1+x));
y__ = zeros(l_max+1,l_max+1);
y__(1+0,1+0) = 1;
for m_val=0:l_max;
if (m_val>0); y__(1+m_val,1+m_val) = y__(1+m_val-1,1+m_val-1)*u*sqrt((2*m_val-1)/(2*m_val)); end;
if (m_val<l_max); y__(1+m_val+1,1+m_val) = x*y__(1+m_val,1+m_val)*sqrt(2*m_val+1); end;
for l_val=m_val+2:l_max;
y__(1+l_val,1+m_val) = ((2*l_val-1)*x*y__(1+l_val-1,1+m_val) - sqrt((l_val+m_val-1)*(l_val-m_val-1))*y__(1+l_val-2,1+m_val))/sqrt((l_val-m_val+0)*(l_val+m_val));
end;%for l_val=m_val+2:l_max;
end;%for m_val=0:l_max;
for l_val=0:l_max;
for m_val=0:l_val;
y__(1+l_val,1+m_val) = y__(1+l_val,1+m_val)*sqrt(2*l_val+1);
end;%for m_val=0:l_val;
end;%for l_val=0:l_max;
