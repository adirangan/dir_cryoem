function ...
[ ...
 FTK_n_delta_v ...
,FTK_delta_x_ ...
,FTK_delta_y_ ...
,FTK_svd_polyval_U_d_ ...
,FTK_svd_expiw__ ...
,FTK_svd_U_d_expiw_s__ ...
] = ...
ampmh_FTK_subselect_1( ...
 FTK ...
,n_delta_v_requested ...
);
if (nargin<2); n_delta_v_requested = []; end;
if isempty(n_delta_v_requested); n_delta_v_requested = 128; end;
delta_r_max = FTK.svd_d_max;
k_p_r_max = FTK.svd_r_max/(2*pi);
pm_N_pixel = delta_r_max * (2*pi*k_p_r_max) / (pi*sqrt(2)) ;
if delta_r_max==0; [FTK_n_delta_v,FTK_delta_x_,FTK_delta_y_] = get_delta_2(delta_r_max,1); end;
if delta_r_max> 0; [FTK_n_delta_v,FTK_delta_x_,FTK_delta_y_] = get_delta_2(delta_r_max,n_delta_v_requested); end;
FTK_svd_polyval_U_d_ = get_svd_polyval_U_d_0(FTK.svd_d_max,FTK.n_svd_d,FTK.svd_d_,FTK.n_svd_l,FTK.svd_l_,FTK.svd_U_d_,FTK_n_delta_v,FTK_delta_x_,FTK_delta_y_);
FTK_svd_expiw__ = exp(-i*(pi/2 - reshape(atan2(FTK_delta_y_,FTK_delta_x_),[FTK_n_delta_v,1]))*reshape(FTK.svd_l_,[1,FTK.n_svd_l]));
FTK_svd_U_d_expiw_s__ = (permute(reshape(FTK_svd_polyval_U_d_,[FTK.n_svd_l,FTK_n_delta_v]),[2,1]).*FTK_svd_expiw__)*diag(FTK.svd_s_);
