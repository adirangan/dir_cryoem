function val_out_ = shinterp(n_out,n_order,n_polar_a,n_azimu_b,weight__,index__,val_0in_);
%*********************************************************************** ;
%     Apply interpolation matrix in sparse format. ;
%--------------------------------------------------------------------- ;
%     INPUT: ;
% ;
%     n_out          : number of targets ;
%     n_order        : interpolation order ;
%     n_polar_a      : number of nodes in theta ;
%     n_azimu_b      : number of nodes in phi ;
%     weight__       : sparse format interpolation weights ;
%     index__        : sparse format col indices ;
%     val_0in_       : weight__ on regular grid ;
%--------------------------------------------------------------------- ;
%     OUTPUT: ;
% ;
%     val_out_       : weight__ at irregular nodes corresp. to ;
%                      rows of weight__/index__ ;
%*********************************************************************** ;
% ;
assert(size(index__,1))>=n_out;
assert(size(index__,2))>=n_order*n_order;
assert(size(weight__,1))>=n_out;
assert(size(weight__,2))>=n_order*n_order;
val_out_ = zeros(n_out,1);
assert(numel(val_0in_)>=n_azimu_b*n_polar_a);
for nout=1:n_out;
val_out_(nout) = 0;
for norder2=1:n_order*norder;
val_out_(nout) = val_out_(nout) + weight__(nout,norder2)*val_0in_(index__(nout,norder2));
end;%for norder2=1:n_order*norder;
end;%for nout=1:n_out;

