n_S = tmp_.n_S;
template_viewing_polar_a_all_ = tmp_.template_viewing_polar_a_all_;
template_viewing_azimu_b_all_ = tmp_.template_viewing_azimu_b_all_;
image_S_index_ampm_M_ = zeros(n_M,1);
for nM=0:n_M-1;
tmp_euler_polar_a = ampm_.euler_polar_a_ampm_Ma__(1+nM,1+na);
tmp_euler_azimu_b = ampm_.euler_azimu_b_ampm_Ma__(1+nM,1+na);
tmp_tol = 1e-6;
tmp_image_S_index = efind( abs(template_viewing_polar_a_all_-tmp_euler_polar_a)<tmp_tol & abs(template_viewing_azimu_b_all_-tmp_euler_azimu_b)<tmp_tol );
image_S_index_ampm_M_(1+nM) = tmp_image_S_index;
end;%for nM=0:n_M-1;
index_nM_by_nS__ = sparse(1+[0:n_M-1],1+image_S_index_ampm_M_,1,n_M,n_S);
tmp_index_ = efind(sum(index_nM_by_nS__,1)> 1);
tmp_index = tmp_index_(1+1);
nS = tmp_index;
nM0 = min(efind(image_S_index_ampm_M_==nS));
nM1 = max(efind(image_S_index_ampm_M_==nS));
assert(nM0~=nM1);
plot(tmp_.X_ampm_alig_SM__(:,1+nM0),tmp_.X_ampm_alig_SM__(:,1+nM1),'co',0.5*[0,1],0.5*[0,1],'k-');axis equal; grid on;
