function ...
[ ...
 parameter ...
,nw_aM_M_ ...
,gamma_z_aM_M_ ...
,M_vs_a_l2_aM_M_ ...
,nw_Ma_M_ ...
,gamma_z_Ma_M_ ...
,M_vs_a_l2_Ma_M_ ...
,M_vs_a_l2_wM__ ...
] = ...
gamma_z_from_a_M_SR0A_0( ...
 parameter ...
,n_w_max ...
,n_k_p_r ...
,a_k_p_wk__ ...
,n_pick ...
,n_M ...
,M_k_p_pkM___ ...
,dnw_pM__ ...
);

verbose=0;
if (verbose); disp(sprintf(' %% [entering gamma_z_from_a_M_SR0A_0]')); end;

if isempty(parameter);
parameter = struct('type','parameter');
end;%if isempty(parameter);
%%%%%%%%;
if (~isfield(parameter,'f_rand')); parameter.f_rand = 0.05; end; %<-- parameter_bookmark. ;
f_rand = parameter.f_rand;

tmp_t=tic();
index_0_ = [0:n_w_max-1];
gamma_z_ = 2*pi*index_0_/n_w_max;
M_vs_a_l2_wM__ = zeros(n_w_max,n_M);
for nM=0:n_M-1;
dnw_p_ = dnw_pM__(:,1+nM);
M_k_p_pk1___ = reshape(M_k_p_pkM___(:,:,1+nM),[n_pick,n_k_p_r,1]);
index_pw__ = zeros(n_pick,n_w_max);
for npick=0:n_pick-1;
index_pw__(1+npick,:) = periodize(index_0_ + dnw_p_(1+npick),0,n_w_max);
end;%for npick=0:n_pick-1;
a_k_p_pkw___ = zeros(n_pick,n_k_p_r,n_w_max);
for nk_p_r=0:n_k_p_r-1;
a_k_p_w_ = a_k_p_wk__(:,1+nk_p_r);
a_k_p_pkw___(:,1+nk_p_r,:) = a_k_p_w_(1+index_pw__);
end;%for nk_p_r=0:n_k_p_r-1;
M_vs_a_pkw___ = zeros(n_pick,n_k_p_r,n_w_max);
M_vs_a_pkw___ = repmat(M_k_p_pk1___,[1,1,n_w_max]) - a_k_p_pkw___;
M_vs_a_l2_w_ = sum(abs(M_vs_a_pkw___).^2,[1,2]);
M_vs_a_l2_wM__(:,1+nM) = M_vs_a_l2_w_;
end;%for nM=0:n_M-1;
tmp_t = toc(tmp_t); if (verbose); disp(sprintf(' %% M_vs_a_l2_wM__: %0.2fs',tmp_t)); end;

X_aM__ = -M_vs_a_l2_wM__; %<-- minimize l2 and maximize X. ;
tmp_z__ = zeros(n_w_max,n_M);

tmp_t=tic();
[ ...
 parameter ...
,gamma_z_aM_M_ ...
,nw_aM_M_ ...
,~ ...
,~ ...
,~ ...
,~ ...
,M_vs_a_l2_aM_M_ ...
,~ ...
] = ...
ampmh_SM_2( ...
 parameter ...
,n_w_max ...
,n_w_max ...
,gamma_z_ ...
,index_0_ ...
,n_M ...
,X_aM__ ...
,tmp_z__ ...
,tmp_z__ ...
,tmp_z__ ...
,tmp_z__ ...
);
M_vs_a_l2_aM_M_ = -M_vs_a_l2_aM_M_;
tmp_t = toc(tmp_t); if (verbose); disp(sprintf(' %% M_vs_a_l2_aM_M_: %0.2fs',tmp_t)); end;

tmp_t=tic();
[ ...
 parameter ...
,gamma_z_Ma_M_ ...
,nw_Ma_M_ ...
,~ ...
,~ ...
,~ ...
,~ ...
,M_vs_a_l2_Ma_M_ ...
,~ ...
] = ...
ampmh_MS_2( ...
 parameter ...
,n_w_max ...
,n_w_max ...
,gamma_z_ ...
,index_0_ ...
,n_M ...
,X_aM__ ...
,tmp_z__ ...
,tmp_z__ ...
,tmp_z__ ...
,tmp_z__ ...
);
M_vs_a_l2_Ma_M_ = -M_vs_a_l2_Ma_M_;
tmp_t = toc(tmp_t); if (verbose); disp(sprintf(' %% M_vs_a_l2_Ma_M_: %0.2fs',tmp_t)); end;

if (verbose); disp(sprintf(' %% [finished gamma_z_from_a_M_SR0A_0]')); end;

