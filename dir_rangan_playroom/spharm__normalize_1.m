function [a_UCTF_UX_Y_ync_norm__] = spharm__normalize_1(pm_n_k_p_r,pm_k_p_r_,pm_weight_k_p_r_,pm_l_max_,a_UCTF_UX_Y_ync__)
n_CTF_rank = size(a_UCTF_UX_Y_ync__,2);
pm_n_lm_ = (pm_l_max_+1).^2;
pm_n_lm_sum = sum(pm_n_lm_);
pm_n_lm_csum_ = cumsum([0;pm_n_lm_]);
pm_l_max_max = max(pm_l_max_); dWtdkd__l_max_max = 2*pm_l_max_max;
m_max_ = -pm_l_max_max : +pm_l_max_max;
n_m_max = length(m_max_);
pm_weight_Y_row_ = zeros(pm_n_lm_sum,1);
pm_weight_Y_col_ = zeros(pm_n_lm_sum,1);
pm_weight_Y_val_ = zeros(pm_n_lm_sum,1);
e_k_Y_ = zeros(pm_n_lm_sum,1);
pm_na=0;
for pm_nk_p_r=0:pm_n_k_p_r-1;
tmp_index_ = pm_na + (0:pm_n_lm_(1+pm_nk_p_r)-1);
pm_weight_Y_row_(1+tmp_index_) = tmp_index_;
pm_weight_Y_col_(1+tmp_index_) = tmp_index_;
pm_weight_Y_val_(1+tmp_index_) = pm_weight_k_p_r_(1+pm_nk_p_r);
e_k_Y_(1+pm_na) = 1;
pm_na=pm_na+pm_n_lm_(1+pm_nk_p_r);
end;%for pm_nk_p_r=0:pm_n_k_p_r-1;
pm_weight_Y_ = sparse(1+pm_weight_Y_row_,1+pm_weight_Y_col_,pm_weight_Y_val_,pm_n_lm_sum,pm_n_lm_sum);
e_avg = ctranspose(e_k_Y_)*(pm_weight_Y_*e_k_Y_);
u_k_Y_ = e_k_Y_./max(sqrt(e_avg),1e-12);
a_avg_ = zeros(n_CTF_rank,1);
for nCTF_rank=0:n_CTF_rank-1;
a_avg_(1+nCTF_rank) = ctranspose(u_k_Y_)*(pm_weight_Y_*a_UCTF_UX_Y_ync__(:,1+nCTF_rank));
end;%for nCTF_rank=0:n_CTF_rank-1;
a_UCTF_UX_Y_ync_norm__ = zeros(pm_n_lm_sum,n_CTF_rank);
for nCTF_rank=0:n_CTF_rank-1;
a_UCTF_UX_Y_ync_norm__(:,1+nCTF_rank) = (a_UCTF_UX_Y_ync__(:,1+nCTF_rank) - 0.0d0*a_avg_(1+nCTF_rank)*u_k_Y_); %<-- do not center. ;
end;%for nCTF_rank=0:n_CTF_rank-1;
a_std = 0;
for nCTF_rank=0:n_CTF_rank-1;
a_std = a_std + ctranspose(a_UCTF_UX_Y_ync_norm__(:,1+nCTF_rank))*(pm_weight_Y_*a_UCTF_UX_Y_ync_norm__(:,1+nCTF_rank));
end;%for nCTF_rank=0:n_CTF_rank-1;
a_std = sqrt(a_std);
a_UCTF_UX_Y_ync_norm__ = a_UCTF_UX_Y_ync_norm__./max(a_std,1e-14);
