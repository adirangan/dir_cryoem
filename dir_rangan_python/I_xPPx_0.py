from dir_matlab_macros import * ;
from scipy.special import jv

r'''
function ...
[ ...
 output ...
,dS0_output ...
,dS1_output ...
,dM0_output ...
,dM1_output ...
,dS0dS0_output ...
,dS0dS1_output ...
,dS1dS0_output ...
,dS1dS1_output ...
,dS0dM0_output ...
,dS0dM1_output ...
,dS1dM0_output ...
,dS1dM1_output ...
,dM0dS0_output ...
,dM0dS1_output ...
,dM1dS0_output ...
,dM1dS1_output ...
,dM0dM0_output ...
,dM0dM1_output ...
,dM1dM0_output ...
,dM1dM1_output ...
] = ...
I_xPPx_0( ...
 K ...
,phi_S ...
,delta_S_ ...
,phi_M ...
,delta_M_ ...
);
%%%%%%%%;
% calculates the integral: ;
% \int_{k=0}^{K} \int_{psi=0}^{2*pi} conj[CTF * S] * M dpsi * kdk ;
% where: ;
% CTF = 2*k*cos(psi - phi_S) ;
% S   = exp( +i*2*pi*k*delta_S * cos(psi - omega_S) ) ;
% M   = 2*k*cos(psi - phi_M) * exp( +i*2*pi*k*delta_M * cos(psi - omega_M) ) ;
% where: ;
% delta_S_ = delta_S * [cos(omega_S);sin(omega_S)] ;
% delta_M_ = delta_M * [cos(omega_M);sin(omega_M)] ;
%%%%;
% Derivatives are calculated with respect to perturbations in: ;
% delta_S_(1+0) and delta_S_(1+1). ;
% delta_M_(1+0) and delta_M_(1+1). ;
%%%%%%%%;
str_thisfunction = 'I_xPPx_0';

na=0;
if (nargin<1+na); K=[]; end; na=na+1;
if (nargin<1+na); phi_S=[]; end; na=na+1;
if (nargin<1+na); delta_S_=[]; end; na=na+1;
if (nargin<1+na); phi_M=[]; end; na=na+1;
if (nargin<1+na); delta_M_=[]; end; na=na+1;

if isempty(K); K = 48.0/(2*pi); end;
if isempty(phi_S); phi_S = 0.0*pi; end;
if isempty(delta_S_); delta_S_ = [1.0;0.0]; end;
if isempty(phi_M); phi_M = 0.5*pi; end;
if isempty(delta_M_); delta_M_ = [0.0;1.0]; end;

flag_1 = 1;
flag_d = nargout>=1+1;
flag_dd = nargout>=1+5;

if flag_d;
d00 = 1; d01 = 0;
d10 = 0; d11 = 1;
end;%if flag_d;

delta_T_ = delta_M_ - delta_S_ ;
delta_T = sqrt(delta_T_(1+0).^2 + delta_T_(1+1).^2) ;
if flag_d;
dS0_delta_T = -delta_T_(1+0)./max(1e-12,delta_T) ;
dS1_delta_T = -delta_T_(1+1)./max(1e-12,delta_T) ;
dM0_delta_T = +delta_T_(1+0)./max(1e-12,delta_T) ;
dM1_delta_T = +delta_T_(1+1)./max(1e-12,delta_T) ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_delta_T = +d00/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS0dS1_delta_T = +d01/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dS1dS0_delta_T = +d10/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS1dS1_delta_T = +d11/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
dS0dM0_delta_T = -d00/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS0dM1_delta_T = -d01/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dS1dM0_delta_T = -d10/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dS1dM1_delta_T = -d11/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
dM0dS0_delta_T = -d00/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM0dS1_delta_T = -d01/max(1e-12,delta_T) + delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dM1dS0_delta_T = -d10/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM1dS1_delta_T = -d11/max(1e-12,delta_T) + delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
dM0dM0_delta_T = +d00/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM0dM1_delta_T = +d01/max(1e-12,delta_T) - delta_T_(1+0)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
dM1dM0_delta_T = +d10/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+0)./max(1e-12,delta_T).^3 ;
dM1dM1_delta_T = +d11/max(1e-12,delta_T) - delta_T_(1+1)*delta_T_(1+1)./max(1e-12,delta_T).^3 ;
%%%%;
end;%if flag_dd;
omega_T = atan2(delta_T_(1+1),delta_T_(1+0)) ;
if flag_d;
dS0_omega_T = +(delta_T_(1+1)*d00  - delta_T_(1+0)*d01)./max(1e-12,delta_T).^2;
dS1_omega_T = +(delta_T_(1+1)*d10  - delta_T_(1+0)*d11)./max(1e-12,delta_T).^2;
dM0_omega_T = -(delta_T_(1+1)*d00  - delta_T_(1+0)*d01)./max(1e-12,delta_T).^2;
dM1_omega_T = -(delta_T_(1+1)*d10  - delta_T_(1+0)*d11)./max(1e-12,delta_T).^2;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_omega_T = +(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS0dS1_omega_T = +(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dS1dS0_omega_T = +(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS1dS1_omega_T = +(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
dS0dM0_omega_T = -(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS0dM1_omega_T = -(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dS1dM0_omega_T = -(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dS1dM1_omega_T = -(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
dM0dS0_omega_T = -(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM0dS1_omega_T = -(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 - 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dM1dS0_omega_T = -(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM1dS1_omega_T = -(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 - 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
dM0dM0_omega_T = +(d01*d00 - d00*d01)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM0dM1_omega_T = +(d01*d10 - d00*d11)./max(1e-12,delta_T).^2 + 2.0*(d00*delta_T_(1+1) - d01*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
dM1dM0_omega_T = +(d11*d00 - d10*d01)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+0)./max(1e-12,delta_T).^4;
dM1dM1_omega_T = +(d11*d10 - d10*d11)./max(1e-12,delta_T).^2 + 2.0*(d10*delta_T_(1+1) - d11*delta_T_(1+0))*delta_T_(1+1)./max(1e-12,delta_T).^4;
%%%%;
end;%if flag_dd;
phi_p = phi_S + phi_M ;
phi_n = phi_S - phi_M ;
t = 2*pi*delta_T ;
tK = t*K ;
if flag_d;
dS0_tK = 2*pi*K*dS0_delta_T;
dS1_tK = 2*pi*K*dS1_delta_T;
dM0_tK = 2*pi*K*dM0_delta_T;
dM1_tK = 2*pi*K*dM1_delta_T;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_tK = 2*pi*K*dS0dS0_delta_T;
dS0dS1_tK = 2*pi*K*dS0dS1_delta_T;
dS1dS0_tK = 2*pi*K*dS1dS0_delta_T;
dS1dS1_tK = 2*pi*K*dS1dS1_delta_T;
%%%%;
dS0dM0_tK = 2*pi*K*dS0dM0_delta_T;
dS0dM1_tK = 2*pi*K*dS0dM1_delta_T;
dS1dM0_tK = 2*pi*K*dS1dM0_delta_T;
dS1dM1_tK = 2*pi*K*dS1dM1_delta_T;
%%%%;
dM0dS0_tK = 2*pi*K*dM0dS0_delta_T;
dM0dS1_tK = 2*pi*K*dM0dS1_delta_T;
dM1dS0_tK = 2*pi*K*dM1dS0_delta_T;
dM1dS1_tK = 2*pi*K*dM1dS1_delta_T;
%%%%;
dM0dM0_tK = 2*pi*K*dM0dM0_delta_T;
dM0dM1_tK = 2*pi*K*dM0dM1_delta_T;
dM1dM0_tK = 2*pi*K*dM1dM0_delta_T;
dM1dM1_tK = 2*pi*K*dM1dM1_delta_T;
%%%%;
end;%if flag_dd;
b0 = besselj(0,tK);
b2 = besselj(2,tK);
b4 = besselj(4,tK);
if flag_d;
dtK_b0 = 0.5*(besselj(0-1,tK) - besselj(0+1,tK)) ;
dtK_b2 = 0.5*(besselj(2-1,tK) - besselj(2+1,tK)) ;
dtK_b4 = 0.5*(besselj(4-1,tK) - besselj(4+1,tK)) ;
end;%if flag_d;
if flag_dd;
dtKdtK_b0 = 0.5*( 0.5*( besselj(0-1-1,tK) - besselj(0-1+1,tK) ) - 0.5*( besselj(0+1-1,tK) - besselj(0+1+1,tK) ) ) ;
dtKdtK_b2 = 0.5*( 0.5*( besselj(2-1-1,tK) - besselj(2-1+1,tK) ) - 0.5*( besselj(2+1-1,tK) - besselj(2+1+1,tK) ) ) ;
dtKdtK_b4 = 0.5*( 0.5*( besselj(4-1-1,tK) - besselj(4-1+1,tK) ) - 0.5*( besselj(4+1-1,tK) - besselj(4+1+1,tK) ) ) ;
end;%if flag_dd;
if flag_d;
dS0_b0 = dtK_b0 * dS0_tK ;
dS1_b0 = dtK_b0 * dS1_tK ;
dM0_b0 = dtK_b0 * dM0_tK ;
dM1_b0 = dtK_b0 * dM1_tK ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_b0 = dtKdtK_b0 * dS0_tK * dS0_tK + dtK_b0 * dS0dS0_tK ;
dS0dS1_b0 = dtKdtK_b0 * dS0_tK * dS1_tK + dtK_b0 * dS0dS1_tK ;
dS1dS0_b0 = dtKdtK_b0 * dS1_tK * dS0_tK + dtK_b0 * dS1dS0_tK ;
dS1dS1_b0 = dtKdtK_b0 * dS1_tK * dS1_tK + dtK_b0 * dS1dS1_tK ;
%%%%;
dS0dM0_b0 = dtKdtK_b0 * dS0_tK * dM0_tK + dtK_b0 * dS0dM0_tK ;
dS0dM1_b0 = dtKdtK_b0 * dS0_tK * dM1_tK + dtK_b0 * dS0dM1_tK ;
dS1dM0_b0 = dtKdtK_b0 * dS1_tK * dM0_tK + dtK_b0 * dS1dM0_tK ;
dS1dM1_b0 = dtKdtK_b0 * dS1_tK * dM1_tK + dtK_b0 * dS1dM1_tK ;
%%%%;
dM0dS0_b0 = dtKdtK_b0 * dM0_tK * dS0_tK + dtK_b0 * dM0dS0_tK ;
dM0dS1_b0 = dtKdtK_b0 * dM0_tK * dS1_tK + dtK_b0 * dM0dS1_tK ;
dM1dS0_b0 = dtKdtK_b0 * dM1_tK * dS0_tK + dtK_b0 * dM1dS0_tK ;
dM1dS1_b0 = dtKdtK_b0 * dM1_tK * dS1_tK + dtK_b0 * dM1dS1_tK ;
%%%%;
dM0dM0_b0 = dtKdtK_b0 * dM0_tK * dM0_tK + dtK_b0 * dM0dM0_tK ;
dM0dM1_b0 = dtKdtK_b0 * dM0_tK * dM1_tK + dtK_b0 * dM0dM1_tK ;
dM1dM0_b0 = dtKdtK_b0 * dM1_tK * dM0_tK + dtK_b0 * dM1dM0_tK ;
dM1dM1_b0 = dtKdtK_b0 * dM1_tK * dM1_tK + dtK_b0 * dM1dM1_tK ;
%%%%;
end;%if flag_dd;
if flag_d;
dS0_b2 = dtK_b2 * dS0_tK ;
dS1_b2 = dtK_b2 * dS1_tK ;
dM0_b2 = dtK_b2 * dM0_tK ;
dM1_b2 = dtK_b2 * dM1_tK ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_b2 = dtKdtK_b2 * dS0_tK * dS0_tK + dtK_b2 * dS0dS0_tK ;
dS0dS1_b2 = dtKdtK_b2 * dS0_tK * dS1_tK + dtK_b2 * dS0dS1_tK ;
dS1dS0_b2 = dtKdtK_b2 * dS1_tK * dS0_tK + dtK_b2 * dS1dS0_tK ;
dS1dS1_b2 = dtKdtK_b2 * dS1_tK * dS1_tK + dtK_b2 * dS1dS1_tK ;
%%%%;
dS0dM0_b2 = dtKdtK_b2 * dS0_tK * dM0_tK + dtK_b2 * dS0dM0_tK ;
dS0dM1_b2 = dtKdtK_b2 * dS0_tK * dM1_tK + dtK_b2 * dS0dM1_tK ;
dS1dM0_b2 = dtKdtK_b2 * dS1_tK * dM0_tK + dtK_b2 * dS1dM0_tK ;
dS1dM1_b2 = dtKdtK_b2 * dS1_tK * dM1_tK + dtK_b2 * dS1dM1_tK ;
%%%%;
dM0dS0_b2 = dtKdtK_b2 * dM0_tK * dS0_tK + dtK_b2 * dM0dS0_tK ;
dM0dS1_b2 = dtKdtK_b2 * dM0_tK * dS1_tK + dtK_b2 * dM0dS1_tK ;
dM1dS0_b2 = dtKdtK_b2 * dM1_tK * dS0_tK + dtK_b2 * dM1dS0_tK ;
dM1dS1_b2 = dtKdtK_b2 * dM1_tK * dS1_tK + dtK_b2 * dM1dS1_tK ;
%%%%;
dM0dM0_b2 = dtKdtK_b2 * dM0_tK * dM0_tK + dtK_b2 * dM0dM0_tK ;
dM0dM1_b2 = dtKdtK_b2 * dM0_tK * dM1_tK + dtK_b2 * dM0dM1_tK ;
dM1dM0_b2 = dtKdtK_b2 * dM1_tK * dM0_tK + dtK_b2 * dM1dM0_tK ;
dM1dM1_b2 = dtKdtK_b2 * dM1_tK * dM1_tK + dtK_b2 * dM1dM1_tK ;
%%%%;
end;%if flag_dd;
if flag_d;
dS0_b4 = dtK_b4 * dS0_tK ;
dS1_b4 = dtK_b4 * dS1_tK ;
dM0_b4 = dtK_b4 * dM0_tK ;
dM1_b4 = dtK_b4 * dM1_tK ;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_b4 = dtKdtK_b4 * dS0_tK * dS0_tK + dtK_b4 * dS0dS0_tK ;
dS0dS1_b4 = dtKdtK_b4 * dS0_tK * dS1_tK + dtK_b4 * dS0dS1_tK ;
dS1dS0_b4 = dtKdtK_b4 * dS1_tK * dS0_tK + dtK_b4 * dS1dS0_tK ;
dS1dS1_b4 = dtKdtK_b4 * dS1_tK * dS1_tK + dtK_b4 * dS1dS1_tK ;
%%%%;
dS0dM0_b4 = dtKdtK_b4 * dS0_tK * dM0_tK + dtK_b4 * dS0dM0_tK ;
dS0dM1_b4 = dtKdtK_b4 * dS0_tK * dM1_tK + dtK_b4 * dS0dM1_tK ;
dS1dM0_b4 = dtKdtK_b4 * dS1_tK * dM0_tK + dtK_b4 * dS1dM0_tK ;
dS1dM1_b4 = dtKdtK_b4 * dS1_tK * dM1_tK + dtK_b4 * dS1dM1_tK ;
%%%%;
dM0dS0_b4 = dtKdtK_b4 * dM0_tK * dS0_tK + dtK_b4 * dM0dS0_tK ;
dM0dS1_b4 = dtKdtK_b4 * dM0_tK * dS1_tK + dtK_b4 * dM0dS1_tK ;
dM1dS0_b4 = dtKdtK_b4 * dM1_tK * dS0_tK + dtK_b4 * dM1dS0_tK ;
dM1dS1_b4 = dtKdtK_b4 * dM1_tK * dS1_tK + dtK_b4 * dM1dS1_tK ;
%%%%;
dM0dM0_b4 = dtKdtK_b4 * dM0_tK * dM0_tK + dtK_b4 * dM0dM0_tK ;
dM0dM1_b4 = dtKdtK_b4 * dM0_tK * dM1_tK + dtK_b4 * dM0dM1_tK ;
dM1dM0_b4 = dtKdtK_b4 * dM1_tK * dM0_tK + dtK_b4 * dM1dM0_tK ;
dM1dM1_b4 = dtKdtK_b4 * dM1_tK * dM1_tK + dtK_b4 * dM1dM1_tK ;
%%%%;
end;%if flag_dd;
%mode_2 = ( -4*pi*cos(phi_p - 2*omega_T) * K^3 * besselj(3,tK) ) / t ;
%mode_2 = -4*pi*cos(phi_p - 2*omega_T) * K^4 * ( besselj(2,tK) + besselj(4,tK) ) / 6;
mode_2 = -4*pi*cos(phi_p - 2*omega_T) * K^4 * ( + b2 + b4 )/6;
if flag_d;
dS0_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS0_b4 )/6 ...
;
dS1_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dS1_b4 )/6 ...
;
dM0_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM0_b4 )/6 ...
;
dM1_mode_2 = ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( +dM1_b4 )/6 ...
;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS0_b4 )/6 ...
;
dS0dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dS1_b4 )/6 ...
;
dS1dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS0_b4 )/6 ...
;
dS1dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dS1_b4 )/6 ...
;
%%%%;
dS0dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM0_b4 )/6 ...
;
dS0dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS0_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS0dM1_b4 )/6 ...
;
dS1dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM0_b4 )/6 ...
;
dS1dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dS1_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dS1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dS1dM1_b4 )/6 ...
;
%%%%;
dM0dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS0_b4 )/6 ...
;
dM0dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dS1_b4 )/6 ...
;
dM1dS0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dS0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS0_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS0_b4 )/6 ...
;
dM1dS1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dS1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dS1_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dS1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dS1_b4 )/6 ...
;
%%%%;
dM0dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM0_b4 )/6 ...
;
dM0dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM0_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM0_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM0dM1_b4 )/6 ...
;
dM1dM0_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dM0_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM0_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM0_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM0_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM0_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM0_b4 )/6 ...
;
dM1dM1_mode_2 = ...
-4*pi* (-(+cos(phi_p - 2*omega_T) * -2*dM1_omega_T) * -2*dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1dM1_omega_T) * K^4 * ( + b2 + b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( +dM1_b4 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM1_b2 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM1_b2 )/6 ...
-4*pi* (-sin(phi_p - 2*omega_T) * -2*dM1_omega_T) * K^4 * ( dM1_b4 )/6 ...
-4*pi*cos(phi_p - 2*omega_T) * K^4 * ( dM1dM1_b4 )/6 ...
;
%%%%;
end;%if flag_dd;
%mode_0 = 4*pi*cos(phi_n) * ( tK^3 * besselj(1,tK) - 2*tK^2 *besselj(2,tK) ) / t^4 ;
%mode_0 = 4*pi*cos(phi_n) * K^4 * ( besselj(0,tK)/4 + besselj(2,tK)/6 - besselj(4,tK)/12 ) ;
mode_0 = 4*pi*cos(phi_n) * K^4 * ( b0/4 + b2/6 - b4/12 );
if flag_d;
dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0_b4/12 ) ...
;
dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1_b4/12 ) ...
;
dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0_b4/12 ) ...
;
dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1_b4/12 ) ...
;
end;%if flag_d;
if flag_dd;
%%%%;
dS0dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dS0_b4/12 ) ...
;
dS0dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dS1_b4/12 ) ...
;
dS1dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dS0_b4/12 ) ...
;
dS1dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dS1_b4/12 ) ...
;
%%%%;
dS0dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dM0_b4/12 ) ...
;
dS0dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS0dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS0dM1_b4/12 ) ...
;
dS1dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dM0_b4/12 ) ...
;
dS1dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dS1dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dS1dM1_b4/12 ) ...
;
%%%%;
dM0dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dS0_b4/12 ) ...
;
dM0dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dS1_b4/12 ) ...
;
dM1dS0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dS0_b4/12 ) ...
;
dM1dS1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dS1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dS1_b4/12 ) ...
;
%%%%;
dM0dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dM0_b4/12 ) ...
;
dM0dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM0dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM0dM1_b4/12 ) ...
;
dM1dM0_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM0_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM0_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dM0_b4/12 ) ...
;
dM1dM1_mode_0 = ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM1_b0/4  ) ...
+4*pi*cos(phi_n) * K^4 * ( + dM1dM1_b2/6  ) ...
+4*pi*cos(phi_n) * K^4 * ( - dM1dM1_b4/12 ) ...
;
%%%%;
end;%if flag_dd;
output = mode_0 + mode_2 ;
if flag_d
dS0_output = dS0_mode_0 + dS0_mode_2 ;
dS1_output = dS1_mode_0 + dS1_mode_2 ;
dM0_output = dM0_mode_0 + dM0_mode_2 ;
dM1_output = dM1_mode_0 + dM1_mode_2 ;
end;%if flag_d
if flag_dd;
%%%%;
dS0dS0_output = dS0dS0_mode_0 + dS0dS0_mode_2 ;
dS0dS1_output = dS0dS1_mode_0 + dS0dS1_mode_2 ;
dS1dS0_output = dS1dS0_mode_0 + dS1dS0_mode_2 ;
dS1dS1_output = dS1dS1_mode_0 + dS1dS1_mode_2 ;
%%%%;
dS0dM0_output = dS0dM0_mode_0 + dS0dM0_mode_2 ;
dS0dM1_output = dS0dM1_mode_0 + dS0dM1_mode_2 ;
dS1dM0_output = dS1dM0_mode_0 + dS1dM0_mode_2 ;
dS1dM1_output = dS1dM1_mode_0 + dS1dM1_mode_2 ;
%%%%;
dM0dS0_output = dM0dS0_mode_0 + dM0dS0_mode_2 ;
dM0dS1_output = dM0dS1_mode_0 + dM0dS1_mode_2 ;
dM1dS0_output = dM1dS0_mode_0 + dM1dS0_mode_2 ;
dM1dS1_output = dM1dS1_mode_0 + dM1dS1_mode_2 ;
%%%%;
dM0dM0_output = dM0dM0_mode_0 + dM0dM0_mode_2 ;
dM0dM1_output = dM0dM1_mode_0 + dM0dM1_mode_2 ;
dM1dM0_output = dM1dM0_mode_0 + dM1dM0_mode_2 ;
dM1dM1_output = dM1dM1_mode_0 + dM1dM1_mode_2 ;
%%%%;
end;%if flag_dd;
'''

def I_xPPx_0(
        K=None,
        phi_S=None,
        delta_S_=None,
        phi_M=None,
        delta_M_=None,
):
    if K is None: K = 48.0/(2*pi);
    if phi_S is None: phi_S = 0.0*pi;
    if delta_S_ is None: delta_S_ = torch.tensor([1.0,0.0]).to(dtype=torch.float32);
    if phi_M is None: phi_M = 0.5*pi;
    if delta_M_ is None: delta_M_ = torch.tensor([0.0,1.0]).to(dtype=torch.float32);
    delta_T_ = delta_M_.ravel() - delta_S_.ravel() ;
    delta_T = np.sqrt(delta_T_[0].item()**2 + delta_T_[1].item()**2);
    omega_T = np.arctan2(delta_T_[1].item(),delta_T_[0].item());
    phi_p = phi_S + phi_M;
    phi_n = phi_S - phi_M;
    t = 2*pi*delta_T;
    tK = t*K;
    b0 = jv(0,tK);
    b2 = jv(2,tK);
    b4 = jv(4,tK);
    mode_2 = -4*pi*np.cos(phi_p - 2*omega_T) * K**4 * (b2 + b4)/6 ;
    mode_0 = 4*pi*np.cos(phi_n)*K**4*(b0/4 + b2/6 - b4/12) ;
    output = mode_0 + mode_2;
    return(output);
